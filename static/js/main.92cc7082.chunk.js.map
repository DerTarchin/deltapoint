{"version":3,"sources":["static/logo.svg","utils/decrypt.js","utils/debounce.js","utils/events.js","utils/numformat.js","utils/colorformat.js","utils/data.js","utils/index.js","components/ContentEditable.js","utils/icons.js","components/DateScrubber.js","components/Portfolio.js","components/Balances.js","components/Volatility.js","components/Breakdown.js","components/Charts.js","components/History.js","Interface.js","InterfaceMobile.js","index.js"],"names":["module","exports","CryptoJS","require","decrypt","message","passphrase","encryptedHMAC","substring","encryptedHTML","HmacSHA256","SHA256","toString","salt","enc","Hex","parse","substr","iv","encrypted","key","PBKDF2","keySize","iterations","JSON","AES","padding","pad","Pkcs7","mode","CBC","Utf8","keys","debounce","callback","wait","id","time","performance","now","valid_timeout","setTimeout","call","getClosestParent","elem","selector","Element","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","this","document","ownerDocument","querySelectorAll","i","length","item","parentNode","isEnter","e","keyCode","code","which","isBackspace","ranges","divider","suffix","getNumberProperties","num","invalid","trim","isNaN","_num","replace","toUpperCase","match","map","r","includes","multiplier","find","comma","split","valid","string","number","value","join","round","scale","arr","sig","Math","makeDoubleDecimal","props","formatMoney","val","dontRound","colorMap","tactical","conservative","aggressive","rotation","other","cash","bg","getColorProperties","hex","toRGB","result","exec","parseInt","g","b","h","max","min","l","d","a","rgbStr","hslStr","getAlpha","parseFloat","glow","colorProps","type","color","outer","inner","getLatest","data","date","moment","up","latest","day","clone","datestr","format","generateAggs","stopDate","history","feeAdjustments","tradeDetails","nulls","buys","sells","trades","cycles","fees","dividends","max_drawdown","max_upside","avg_pl_perc","days_in_trade","avg_days_in_trade","perc_days_in_trade","total_pl","total_pl_perc","sell_trades","current","meta","symbols_traded","forEach","sym","details","years","lastPos","start_date","calcAvg","src","diff","since","isSameOrBefore","year","yearDetails","transactions","filter","t","symbol","pos","positions","adj","coms","commission","c","latestBuy","latestSell","push","amount","reg_fee","getPriceAvg","ts","removeFees","reduce","total","Number","MAX_SAFE_INTEGER","totalShares","shares","totalAmount","price","abs","buy","avg","trueBuy","sell","highs","lows","perc","j","isSame","Object","yDate","isBefore","add","yPos","subtract","yDetails","console","log","pagePos","el","x","y","offsetLeft","scrollLeft","clientLeft","offsetTop","scrollTop","clientTop","offsetParent","frmt","start","end","Date","getFullYear","sepFrmt","m","M","useYear","p5map","inMin","inMax","outMin","outMax","constrain","isNull","ignoreQuotes","undefined","shouldUpdate","component","nextProps","nextState","state","some","cap","str","charAt","slice","noop","ContentEditable","html","defaultHtml","componentDidUpdate","prevProps","setState","clearContent","refs","contentEditable","innerHTML","focus","focusToEnd","range","selection","createRange","selectNodeContents","collapse","window","getSelection","removeAllRanges","addRange","body","createTextRange","moveToElementText","select","selectAll","div","sel","text","innerText","textContent","clear","setText","onInput","persist","allowNewLine","disableEnter","onKeyUp","onKeyPress","target","preventDefault","blur","render","normalized","blacklist","prop","TagProps","ref","placeholder","suppressContentEditableWarning","dangerouslySetInnerHTML","__html","onBlur","onPaste","noPaste","disableMax","whitelist","toLowerCase","tag","Component","threedot","version","xmlns","viewBox","doublearrow","width","height","fill","rotatephone","className","angle","thinsearch","arrow","WEEKDAY","DateScrubber","scrubberEnd","lastDay","componentWillMount","addEventListener","handleResize","handleKey","componentDidMount","drawScrubber","headerIndex","weekdays","activeScrubberEnd","componentWillUnmount","removeEventListener","canvas","rect","getBoundingClientRect","isSameOrAfter","unshift","forceUpdate","setupTicks","ctx","dpr","devicePixelRatio","getContext","setupCanvas","clearRect","distance","calcTickDistance","lineWidth","beginPath","dates","propActiveDates","activeDates","canvasHighlight","strokeStyle","moveTo","lineTo","isBetween","stroke","days","SCRUBBER_TICK","scrub","delay","canvasPos","container","clientHeight","highlight","floor","pageX","renderDates","propActiveDateOpt","activeDateOpt","onDateChange","scrubSelect","selectedDate","scrubAdjust","mod","currentTarget","scrubBackwards","SCRUBBER_RANGE","ticks","override","fmt","onMouseMove","onMouseLeave","onClick","Portfolio","calcData","chart","stopPropagation","passive","shouldComponentUpdate","bind","dataChanged","dataView","contributionAdjustments","mobile","datesKeys","valKey","chartData","labels","datasets","outerGlowColor","outerGlowWidth","lineTension","pointRadius","chartOptions","responsive","maintainAspectRatio","legend","events","elements","line","tension","borderCapStyle","borderColor","borderWidth","borderDash","borderDashOffset","borderJoinStyle","point","radius","backgroundColor","hoverBorderColor","hoverBackgroundColor","annotation","annotations","scaleID","drawTime","layout","scales","yAxes","gridLines","display","drawBorder","xAxes","hover","intersect","animationDuration","tooltips","enabled","custom","context","tooltipEl","getElementById","createElement","classList","appendChild","opacity","remove","yAlign","innerHtml","title","lines","querySelector","left","top","position","style","innerWidth","pageXOffset","caretX","pageYOffset","caretY","tooltipRect","options","Balances","balance","ytd","pl","getAttribute","setAttribute","showData","allowAnimations","old","shouldAnimate","ytd_contributions","anim","balance_from","ytd_from","pl_from","ytdxx","maxxx","getMaxContributions","ytdRange","valAnims","pause","anime","targets","plPerc","easing","duration","update","balance_from_history","valEls","n","ytd_from_history","pl_from_history","pair","list","max_contribution","ytdPerc","vts","vts_fees","total_contributions","plRange","commIndex","currComm","isAfter","data-val","background","boxShadow","total_fees","months","calcAge","Volatility","bars","stop","prev","prevstr","prevClose","v","high","cash_balance","low","curr","bar","VTS","tickers","label","allocation","Breakdown","resizeGraphs","calcTradeDetails","getVTS","dets","strat","trans","currData","graphs","svg","graphspace","size","clientWidth","baseRadius","strokeDasharray","PI","strokeDashoffset","crc","circle","transform","index","syms","avgs","cost","useOther","slide","stdDeviation","in","cx","cy","data-index","data-perc","goal","sort","sub","active","data-type","visibility","plPercVal","isNeg","Charts","toggle","PERC","INITIAL_STATE","search","selectedSymbol","toggledYears","showAllTransactions","showSymbolList","History","isActiveVTS","last_updated","latestVTS","vts_rates","vtsIndexOf","prevState","show","filters","fadeInRows","input","setAggs","fadeInSymbols","startsWith","elLeft","parentLeft","scrollTo","getSym","detailtransactions","aggs","rows","rowsAnime","timeline","complete","opts","optsAnime","setSym","skipSearch","getXY","touches","clientX","pageY","clientY","moveWindowStart","drag","startX","startY","lastX","lastY","interface","moveWindow","action","transitionDuration","symdetails","percDragged","screen","dragged","borderRadius","dirX","dirY","moveWindowEnd","fast","close","typeMap","fee","transfer","dividend","lData","renderStockOpts","selected","data-sym","renderTransactions","reverse","f","textTransform","renderDetails","activeDot","small","currPL","currPLPerc","o","yaggs","toggled","trade","onTouchStart","onTouchMove","onTouchEnd","onMouseDown","onMouseUp","onKeyDown","onChange","Interface","showHelp","showHistory","componentWillReceiveProps","getElementsByClassName","rest","fromStartDate","toStartDate","fromDiff","toDiff","diffs","fromdiff","todiff","fromdiffhistory","todiffhistory","dateMenuAnim","currFromDate","currToDate","dateOptBg","loaded","opt","dateOpts","offset","appOptBg","dvDollar","dvPerc","appOpts","onSettingsChange","changeHeader","newState","hideHistory","classes","data-slide","formatted","data-opt","range_count","range_type","InterfaceMobile","swipe","acctIndex","posIndex","app","processSlides","slides","children","transformOrigin","acct","Swipe","account","startSlide","speed","draggable","continuous","disableScroll","dir","tileAnime","marginTop","menu","contains","fromElDay","fromElRest","toElDay","toElRest","init","moveHeaderStart","transitionTimingFunction","hasAttribute","alpha","menuOpen","moveHeader","appbg","moveHeaderEnd","hideMenu","showMenu","dateChange","dateFrom","from","dateTo","to","changed","sep","datesRender","defaultValue","REQUEST","DATA_URL","IS_ENTER","NOW","DATE_OPTS","App","unlockError","showUnlock","mobileOrientation","orientation","error","response","alert","encryptedMsg","unlock","loginAnime","unlockInput","dertarchinroth","timestamp","accounts","activeAccount","decryptedMsg","acctData","startDate","adjData","activeData","trimData","LOGIN_ANIM_DURATION","hideUnlockError","tcontrib","contrib","isOpt","isMobile","interfaceProps","alt","ReactDOM"],"mappings":"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","file":"static/js/main.92cc7082.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.75c537f9.svg\";","const CryptoJS = require('crypto-js')\n\nexport const decrypt = (message, passphrase) => {\n  const encryptedHMAC = message.substring(0, 64),\n        encryptedHTML = message.substring(64),\n        decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();\n\n  if (decryptedHMAC !== encryptedHMAC) return; // incorrect pass\n\n  const keySize = 256/32, \n        iterations = 1000,\n        salt = CryptoJS.enc.Hex.parse(encryptedHTML.substr(0, 32)),\n        iv = CryptoJS.enc.Hex.parse(encryptedHTML.substr(32, 32)),\n        encrypted = encryptedHTML.substring(64),\n        key = CryptoJS.PBKDF2(passphrase, salt, { keySize, iterations });\n\n  return JSON.parse(CryptoJS.AES.decrypt(encrypted, key, {\n      iv: iv,\n      padding: CryptoJS.pad.Pkcs7,\n      mode: CryptoJS.mode.CBC\n  }).toString(CryptoJS.enc.Utf8));\n}","// DEBOUNCE\nconst keys = {}\nexport const debounce = (callback, wait, id) => {\n  const key = id || callback;\n  keys[key] = {\n    callback,\n    time: performance.now()\n  };\n\n  const valid_timeout = keys[key].time;\n  setTimeout(() => {\n    if(keys[key] && valid_timeout === keys[key].time) {\n      const call = keys[key].callback;\n      delete keys[key];\n      call();\n    }\n  }, wait);\n}","/*\n * Polyfill for IE/Edge lack of '.path' property\n * https://github.com/DieterHolvoet/event-propagation-path/blob/master/propagationPath.js\n */\nexport const propagationPath = e => {\n  const polyfill = () => {\n    let element = e.target || null;\n    const pathArr = [element];\n    if (!element || !element.parentElement) return [];\n    while (element.parentElement) {\n      element = element.parentElement;\n      pathArr.unshift(element);\n    }\n    return pathArr;\n  }\n  return e.path || (e.composedPath && e.composedPath()) || polyfill();\n};\n\nexport const getClosestParent = (elem, selector) => {\n  // Element.matches() polyfill\n  if (!Element.prototype.matches) {\n      Element.prototype.matches =\n          Element.prototype.matchesSelector ||\n          Element.prototype.mozMatchesSelector ||\n          Element.prototype.msMatchesSelector ||\n          Element.prototype.oMatchesSelector ||\n          Element.prototype.webkitMatchesSelector ||\n          function(s) {\n              var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n                  i = matches.length;\n              while (--i >= 0 && matches.item(i) !== this) {}\n              return i > -1;\n          };\n  }\n  // Get the closest matching element\n  for ( ; elem && elem !== document; elem = elem.parentNode ) {\n    if ( elem.matches( selector ) ) return elem;\n  }\n  return null;\n};\n\nexport const isEnter = e => (e.key || e.keyCode || e.code) === 'Enter' || e.which === 13;\nexport const isEsc = e => (e.key || e.keyCode || e.code) === 'Escape' || e.which === 27;\nexport const isBackspace = e => (e.key || e.keyCode || e.code) === 'Backspace' || e.which === 8;","const ranges = [\n  { divider: 1e18, suffix: 'P' },\n  { divider: 1e15, suffix: 'E' },\n  { divider: 1e12, suffix: 'T' },\n  { divider: 1e9 , suffix: 'B' },\n  { divider: 1e6 , suffix: 'M' },\n  { divider: 1e3 , suffix: 'K' }\n];\n\nconst getNumberProperties = num => {\n  const invalid = {}\n  if(typeof num === 'string') num = num.trim();\n  // check if empty string or undefined\n  if(num !== 0 && !num) return invalid;\n  // check if it's just a non-digit char\n  if((num+'').length === 1 && isNaN(num)) return invalid;\n  let _num = (num + '').replace(/,/g,''),\n      suffix = _num[_num.length-1].toUpperCase();\n  // split character at end\n  if(suffix.match(/^[A-Z]+$/)) _num = _num.substring(0, _num.length-1);\n  else suffix = null;\n  // check if not a number\n  if(isNaN(+_num)) return invalid;\n  // check incorrect suffix\n  if(suffix && !ranges.map(r => r.suffix).includes(suffix)) return invalid;\n  // return values - it's a number!\n  const multiplier = suffix ? ranges.find(r => r.suffix === suffix).divider : 1;\n  // create comma val\n  const comma = ((+_num * multiplier) + '').split('.');\n  comma[0] = comma[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n  return {\n    valid: true,\n    string: num,\n    number: +_num,\n    value: +_num * multiplier,\n    comma: comma.join('.'),\n    suffix,\n    multiplier,\n  }\n}\n\nconst formatNumber = (num, decimals) => {\n  const _num = getNumberProperties(num);\n  if(!_num) return '';\n  for (var i = 0; i < ranges.length; i++) {\n    if (_num.value >= ranges[i].divider) {\n      const condensed = parseFloat((_num.value / ranges[i].divider).toFixed(decimals)) + '' + ranges[i].suffix;\n      if(condensed.length > 4 + decimals) return formatNumber(_num.value, decimals - 1);\n      return condensed;\n    }\n  }\n  return _num.value+'';\n}\n\nconst splitNumberSuffix = num => {\n  const _num = getNumberProperties(num);\n  if(!_num) return ['', ''];\n  return [_num.number, _num.suffix]\n}\n\nconst getFullNumber = num => {\n  const _num = getNumberProperties(num);\n  if(!_num) return;\n  return _num.value;\n}\n\nconst round = (num, scale=0) => {\n  if(!(\"\" + num).includes(\"e\")) {\n    return +(Math.round(num + \"e+\" + scale)  + \"e-\" + scale);\n  } else {\n    var arr = (\"\" + num).split(\"e\");\n    var sig = \"\"\n    if(+arr[1] + scale > 0) {\n      sig = \"+\";\n    }\n    return +(Math.round(+arr[0] + \"e\" + sig + (+arr[1] + scale)) + \"e-\" + scale);\n  }\n}\n\nconst makeDoubleDecimal = props => {\n  if(!props.valid) return props;\n  if(!props.comma.includes('.')) props.comma += '.00';\n  if(props.comma.split('.')[1].length < 2) props.comma += '0';\n  return props;\n}\n\nconst formatMoney = (val, dontRound) => makeDoubleDecimal(getNumberProperties(dontRound ? val : round(val, 2))).comma\n\nexport {\n  formatNumber,\n  splitNumberSuffix,\n  getFullNumber,\n  getNumberProperties,\n  makeDoubleDecimal,\n  formatMoney,\n  round,\n}","export const colorMap = {\n  tactical: '#66ff85', // green,\n  conservative: '#4dffff', // blue \n  aggressive: '#4d9dff', // dark blue faded\n  // used to be \"cash\"\n  rotation: '#b399ff', // lilac\n  other: '#ff66b3', // pink\n  cash: '#445db1', // same as bg for now\n  bg: '#445db1', // dark blue faded\n}\n\nexport const getColorProperties = hex => {\n  const toRGB = hex => {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  }\n\n  let { r, g, b } = toRGB(hex);\n  r /= 255; g /= 255; b /= 255;\n  var max = Math.max(r, g, b), min = Math.min(r, g, b);\n  var h, s, l = (max + min) / 2;\n  if(max === min) h = s = 0; // achromatic\n  else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch(max) {\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n        case g: h = (b - r) / d + 2; break;\n        case b: h = (r - g) / d + 4; break;\n        default: break;\n    }\n    h /= 6;\n  }\n  s = Math.round(s*100);\n  l = Math.round(l*100);\n  h = Math.round(360*h);\n\n  return {\n    hex: `#${hex.replace('#','')}`,\n    ...toRGB(hex),\n    h, s, l,\n    a: 1,\n    rgbStr: (r,g,b,a) => `rgb${!a && a !== 0 ? '' : 'a'}(${r},${g},${b}${!a && a !== 0 ? '' : `,${a}`})`,\n    hslStr: (h,s,l,a) => `hsl${!a && a !== 0 ? '' : 'a'}(${h},${s}%,${l}%${!a && a !== 0 ? '' : `,${a}`})`,\n  }\n}\n\nexport const getAlpha = val => parseFloat(val.split(',')[val.split(',').length-1].replace(')',''))\n\nexport const glow = (colorProps, type=\"outside\") => {\n  const {r, g, b} = colorProps;\n  const color = colorProps.rgbStr(r,g,b,.7);\n  const outer = `0px 0px 7px 0px ${color}`;\n  const inner = `inset 0px 0px 7px 0px ${color}`;\n  if(type === 'both') return `${inner}, ${outer}`;\n  if(type === 'inside') return inner;\n  return outer;\n}","import moment from 'moment';\nimport { round } from '../utils';\n\n// must be a valid date within the data otherwise an infinite loop will ensue\nexport const getLatest = (data, date=moment(), up) => {\n  let latest = {}, day = date.clone();\n  while(!latest.data) {\n    const datestr = day.format('L');\n    if(data[datestr]) {\n      latest = { data: data[datestr], date: day.clone() };\n    }\n    day[up ? 'add' : 'subtract'](1, 'days');\n  }\n  return latest;\n}\n\nexport const generateAggs = (props, stopDate=moment()) => {\n  const { history, feeAdjustments } = props;\n  const latest = getLatest(history, stopDate);\n\n  const tradeDetails = {};\n  const nulls = {\n    buys: 0, // total money spent\n    sells: 0, // total money back\n    trades: 0, // total trades (includes adding to position, partial sells)\n    cycles: 0, // total completed trades (all shares sold)\n    fees: 0,\n    dividends: 0,\n    max_drawdown: 0,\n    max_upside: 0,\n    avg_pl_perc: 0,\n    days_in_trade: 0,\n    avg_days_in_trade: 0,\n    perc_days_in_trade: 0,\n    total_pl: 0,\n    total_pl_perc: 0,\n    sell_trades: null,\n    current: null\n  }\n\n  history.meta.symbols_traded.forEach(sym => {\n    const key = sym;\n    const details = {\n      ...nulls,\n      years: {},\n      ...tradeDetails[key],\n    }\n    // remove those that are unnecessary in overall metrics\n    delete details.perc_days_in_trade;\n    delete details.sell_trades;\n\n    const day = moment(history.meta.start_date, 'L');\n    let lastPos, sells = 0;\n    const calcAvg = (src, lastPos) => {\n      return (src.avg_days_in_trade * src.cycles + day.diff(lastPos.since, 'days') + 1) / (src.cycles + 1);\n    }\n    while(day.isSameOrBefore(stopDate, 'days')) {\n      if(!(day.year() in details.years)) {\n        details.years[day.year()] = { ...nulls };\n        delete details.years[day.year()].current; // not tracked in per-year breakdown\n      }\n      const yearDetails = details.years[day.year()];\n      const data = history[day.format('L')];\n      if(!data) {\n        day.add(1, 'days');\n        if(lastPos) {\n          details.days_in_trade++;\n          yearDetails.days_in_trade++;\n        }\n        continue;\n      }\n      const transactions = (data.transactions || []).filter(t => t.symbol === sym);\n      const pos = data.positions[sym];\n      // if new pos\n      if(pos) details.current = {\n        max_upside: 0,\n        max_drawdown: 0,\n        days_in_trade: 0,\n        ...details.current,\n        ...pos,\n      };\n      if(!pos && lastPos) details.current = null;\n\n      let adj = 0;\n      if(feeAdjustments) {\n        const coms = history.meta.commission.filter(c => moment(c[0], 'L').isSameOrBefore(day));\n        adj = coms[coms.length - 1][1];\n      }\n\n      // calc all trades and dividends\n      let latestBuy = [], latestSell = [];\n      for(let i = 0; i < transactions.length; i++) {\n        const t = transactions[i];\n        if(['buy','sell'].includes(t.type)) {\n            details.trades++;\n            yearDetails.trades++;\n        }\n        if(t.type === 'buy') {\n          latestBuy.push(t);\n          details.buys += t.amount + adj;\n          yearDetails.buys += t.amount + adj;\n          details.fees += t.commission + t.reg_fee;\n          yearDetails.fees += t.commission + t.reg_fee;\n        }\n        if(t.type === 'sell') {\n          sells++;\n          latestSell.push(t);\n          if(!pos) {\n            if(lastPos) {\n              details.avg_days_in_trade = calcAvg(details, lastPos);\n              yearDetails.avg_days_in_trade = calcAvg(yearDetails, lastPos);\n            }\n            details.cycles++;\n            yearDetails.cycles++;\n            // calc avg days in trade using \"since\" field in pos (always off by one)\n          }\n          details.sells += t.amount + adj;\n          yearDetails.sells += t.amount + adj;\n          details.fees += t.commission + t.reg_fee;\n          yearDetails.fees += t.commission + t.reg_fee;\n        }\n        if(t.type === 'dividend') {\n          details.dividends += t.amount;\n          yearDetails.dividends += t.amount;\n          details.sells += t.amount;\n          yearDetails.sells += t.amount;\n        }\n      }\n\n      // calc max upside, downside and days in trade\n      if(pos || latestBuy.length || latestSell.length) {\n        const getPriceAvg = (ts, removeFees, key) => {\n          if(key === 'h') return ts.reduce((total, val) => Math.max(total, val.h || 0), 0);\n          if(key === 'l') return ts.reduce((total, val) => Math.min(total, val.l || 0), Number.MAX_SAFE_INTEGER);\n          const totalShares = ts.reduce((total, val) => total + val.shares, 0);\n          const totalAmount = ts.reduce((total, val) => total + (removeFees ? val.shares * val.price : val.amount), 0);\n          return Math.abs(totalAmount / totalShares);\n        }\n        // gets current position, a sold position, or a day trade avg\n        const buy = (pos || lastPos || {}).avg || getPriceAvg(latestBuy),\n              trueBuy = (pos || lastPos || {}).avg || getPriceAvg(latestBuy, true),\n              sell = pos ? pos.c : getPriceAvg(latestSell),\n              highs = pos ? pos.h : getPriceAvg(latestSell, null, 'h'),\n              lows = pos ? pos.l : getPriceAvg(latestSell, null, 'l'); // to calc intra-day highs\n        if(pos) {\n          details.days_in_trade++;\n          yearDetails.days_in_trade++;\n          // calc % of the year spent in trades\n          yearDetails.perc_days_in_trade = (yearDetails.days_in_trade * 100) / 365;\n          details.current.days_in_trade++;\n        }\n        let perc =  100 * (highs - trueBuy) / trueBuy; // to calc intra-day highs\n        // calc max drawdowns and gains\n        details.max_upside = Math.max(details.max_upside, perc);\n        yearDetails.max_upside = Math.max(yearDetails.max_upside, perc);\n        if(pos) details.current.max_upside = Math.max(details.current.max_upside, perc);\n        perc =  100 * (lows - trueBuy) / trueBuy; // to calc intra-day lows\n        details.max_drawdown = Math.min(details.max_drawdown, perc);\n        yearDetails.max_drawdown = Math.min(yearDetails.max_drawdown, perc);\n        if(pos) details.current.max_drawdown = Math.min(details.current.max_drawdown, perc)\n\n        // store sells as P/L, calc avg P/L\n        perc = 100 * (sell - buy) / buy;\n        for(let j = 0; j < latestSell.length; j++) {\n          if(!yearDetails.sell_trades) yearDetails.sell_trades = [];\n          details.avg_pl_perc = (details.avg_pl_perc * (sells - 1) + perc) / sells;\n          yearDetails.avg_pl_perc = (yearDetails.avg_pl_perc * yearDetails.sell_trades.length + perc) / (yearDetails.sell_trades.length + 1);\n          yearDetails.sell_trades.push([latestSell[j], buy, perc]);\n        }\n      }\n\n      // calc final values\n      if(day.isSame(latest.date, 'days')) {\n\n        // apply current trades\n        if(pos) {\n          details.sells += pos.shares * pos.c;\n          yearDetails.sells += pos.shares * pos.c;\n        }\n        // for every year, apply any remaining trades at end of year as \"sells\"\n        // and \"buys\" for the next year\n        Object.keys(details.years).forEach(year => {\n          // first day of year, add current positions (as long as they were held previously)\n          let yDate = moment(`1/1/${year}`, 'L');\n          if(yDate.isBefore(stopDate)) {\n            while(!history[yDate.format('L')]) yDate.add(1, 'days');\n            const yPos = history[yDate.format('L')].positions[sym];\n            if(yPos) {\n              let shares = yPos.shares;\n              (history[yDate.format('L')].transactions || []).forEach(t => {\n                if(t.symbol === sym && t.type === 'buy') shares -= t.shares;\n              })\n              details.years[year].buys -= shares * yPos.c;\n            } \n          }\n          // last day of year\n          yDate = moment(`12/31/${year}`, 'L');\n          if(yDate.isBefore(stopDate)) {\n            while(!history[yDate.format('L')]) yDate.subtract(1, 'days');\n            const yPos = history[yDate.format('L')].positions[sym];\n            if(yPos) details.years[year].sells += yPos.shares * yPos.c;\n          }\n        })\n        \n        // calc totals\n        details.total_pl = details.sells - Math.abs(details.buys);\n        let perc = 100 * details.total_pl / Math.abs(details.buys);\n        details.total_pl_perc = perc;\n        Object.keys(details.years).forEach(year => {\n          const yDetails = details.years[year];\n          yDetails.total_pl = yDetails.sells - Math.abs(yDetails.buys);\n          perc = 100 * yDetails.total_pl / Math.abs(yDetails.buys);\n          yDetails.total_pl_perc = perc;\n        })\n      }\n\n      // iterate\n      tradeDetails[key] = details;\n      lastPos = pos;\n      day.add(1, 'days');\n    }\n  });\nconsole.log(tradeDetails)\n  return tradeDetails;\n}","import { decrypt } from './decrypt';\nimport { debounce } from './debounce';\nimport { \n  isEsc,\n  isEnter,\n  isBackspace,\n  propagationPath,\n  getClosestParent,\n} from './events';\nimport {\n  formatNumber,\n  splitNumberSuffix,\n  getFullNumber,\n  getNumberProperties,\n  makeDoubleDecimal,\n  formatMoney,\n  round,\n} from './numformat';\nimport {\n  getColorProperties,\n  colorMap,\n  getAlpha,\n  glow\n} from './colorformat';\nimport {\n  getLatest,\n  generateAggs\n} from './data';\n\nconst pagePos = el => {\n  const pos = {x: 0, y: 0};\n  while (el) {\n    pos.x += (el.offsetLeft - el.scrollLeft + el.clientLeft);\n    pos.y += (el.offsetTop - el.scrollTop + el.clientTop);     \n    el = el.offsetParent;\n  }\n  return pos;\n}\n\n// string formatting date range\nconst frmt = (start, end) => {\n  const year = (new Date()).getFullYear();\n  if(start && !end && start.year() === year) return start.format('MMM D');\n  if(start && !end) return start.format('MMM D, YYYY');\n  if(end && !start && end.year() === year) return end.format('MMM D');\n  if(end && !start) return end.format('MMM D, YYYY');\n  if(start.year() !== end.year() || end.year() !== year) return [\n    start.format('MMM D, YYYY'),\n    end.format('MMM D, YYYY')\n  ];\n  return [\n    start.format('MMM D'),\n    end.format('MMM D')\n  ]\n}\n\n// seperated formatting date range\nconst sepFrmt = (start, end) => {\n  const year = (new Date()).getFullYear();\n  if(start && !end) return {\n    y: start.year(),\n    m: start.format('MMM'),\n    M: start.format('MMMM'),\n    d: start.format('D'),\n    useYear: start.year() !== year\n  };\n  if(end && !start) return {\n    y: end.year(),\n    m: end.format('MMM'),\n    M: end.format('MMMM'),\n    d: end.format('D'),\n    useYear: end.year() !== year\n  };\n  return [\n    {\n      y: start.year(),\n      m: start.format('MMM'),\n      M: start.format('MMMM'),\n      d: start.format('D'),\n      useYear: start.year() !== end.year()\n    }, {\n      y: end.year(),\n      m: end.format('MMM'),\n      M: end.format('MMMM'),\n      d: end.format('D'),\n      useYear: start.year() !== end.year() || end.year() !== year\n    }\n  ]\n}\n\nconst p5map = (val, inMin, inMax, outMin, outMax) => outMin + (outMax - outMin) * ((val - inMin) / (inMax - inMin))\n\nconst constrain = (val, min, max) => val < min ? min : val > max ? max : val\n\nconst isNull = (val, ignoreQuotes) => !(val !== undefined && val !== null && (ignoreQuotes || val !== ''));\n\n// calcs if component props changed, ignoring ref changes (1-level deep only)\nconst shouldUpdate = (component, nextProps, nextState) => {\n  if(nextState !== component.state) return true;\n  return Object.keys(nextProps).some(key => nextProps[key] !== component.props[key]);\n}\n\nconst cap = str => !str ? str : str.charAt(0).toUpperCase() + str.slice(1);\n\nexport {\n  cap,\n  frmt, \n  isEsc,\n  isNull,\n  sepFrmt,\n  pagePos,\n  colorMap,\n  debounce,\n  getLatest,\n  isBackspace,\n  shouldUpdate,\n  generateAggs,\n  propagationPath,\n  splitNumberSuffix,\n  getColorProperties,\n  getNumberProperties,\n  makeDoubleDecimal,\n  getClosestParent,\n  getFullNumber,\n  formatNumber,\n  formatMoney,\n  constrain,\n  getAlpha,\n  decrypt,\n  isEnter,\n  round,\n  p5map,\n  glow,\n}","import React, { Component } from 'react';\nimport { isEnter, isBackspace, isNull } from '../utils';\n\nconst DATA_MAX = 49;\nconst noop = () => {};\n\nexport default class ContentEditable extends Component {\n  state = {\n    html: isNull(this.props.defaultHtml) ? this.props.html : this.props.defaultHtml,\n  }\n\n  componentDidUpdate = prevProps => {\n    const { html } = this.props;\n    if(prevProps.html !== html && typeof html === 'string' && html !== this.state.html) {\n      this.setState({ html });\n    }\n  }\n\n  clearContent = () => {\n    this.refs.contentEditable.innerHTML = '';\n    this.setState({ html: ' ' }, () => this.setState({ html: '' }));\n  }\n\n  focus = () => {\n    this.refs.contentEditable.focus();\n    setTimeout(() => this.refs.contentEditable.focus(), 20);\n  }\n\n  focusToEnd = () => {\n    let range, selection;\n    if(document.createRange) { //Firefox, Chrome, Opera, Safari, IE 9+\n      range = document.createRange(); //Create a range (a range is a like the selection but invisible)\n      range.selectNodeContents(this.el()); //Select the entire contents of the element with the range\n      range.collapse(false); //collapse the range to the end point. false means collapse to end rather than the start\n      selection = window.getSelection(); //get the selection object (allows you to change selection)\n      selection.removeAllRanges(); //remove any selections already made\n      selection.addRange(range); //make the range you have just created the visible selection\n    } else if(document.selection) { //IE 8 and lower\n      range = document.body.createTextRange(); //Create a range (a range is a like the selection but invisible)\n      range.moveToElementText(this.el()); //Select the entire contents of the element with the range\n      range.collapse(false); //collapse the range to the end point. false means collapse to end rather than the start\n      range.select(); //Select the range (make it the visible selection\n    }\n  }\n\n  selectAll = () => {\n    const div = this.refs.contentEditable;\n    window.setTimeout(() => {\n      if(!div) return;\n      let sel, range;\n      if (window.getSelection && document.createRange) {\n        range = document.createRange();\n        range.selectNodeContents(div);\n        sel = window.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(range);\n      } else if (document.body.createTextRange) {\n        range = document.body.createTextRange();\n        range.moveToElementText(div);\n        range.select();\n      }\n    }, 1);\n  }\n\n  el = () => this.refs.contentEditable\n  text = () => this.refs.contentEditable.innerText ||  this.refs.contentEditable.textContent\n  clear = () => this.clearContent()\n  \n  setText = (html, callback) => {\n    if(this.state.html !== html) this.setState({ html }, callback);\n    else if(callback) callback();\n  }\n\n  onInput = e => {\n    e.persist();\n    const { \n      allowNewLine,\n      disableEnter,\n      onInput,\n      onKeyUp,\n      onKeyPress\n    } = this.props;\n    const html = e.target.innerText || e.target.textContent;\n    if(!allowNewLine && isEnter(e)) {\n      e.preventDefault();\n      if(!disableEnter) e.target.blur();\n      this.setState({ html }, () => (onInput || onKeyUp || onKeyPress || noop)(e, html));\n    }\n    else (onInput || onKeyUp || onKeyPress || noop)(e, html);\n  }\n\n  render = () => {\n    const { props } = this;\n    const normalized = {}, \n          blacklist = [\n            'allowNewLine',\n            'disableMax',\n            'whitelist',\n            'onInput',\n            'onKeyUp',\n            'onBlur',\n            'html',\n            'noPaste',\n            'onKeyPress',\n            'defaultHtml',\n            'disableEnter',\n            'placeholder',\n            'tag'\n          ];\n    for(let prop in props) if(!blacklist.includes(prop)) normalized[prop] = props[prop];\n\n    const TagProps = {\n      ...normalized,\n      ref: 'contentEditable',\n      'data-placeholder': props.placeholder || props['data-placeholder'],\n      contentEditable: true,\n      suppressContentEditableWarning: true,\n      dangerouslySetInnerHTML: {__html: this.state.html},\n      onInput: props.onInput ? this.onInput : null,\n      onKeyUp: props.onKeyUp ? this.onInput : null,\n      onBlur: e => {\n        e.persist();\n        const html = e.target.innerText || e.target.textContent;\n        this.setState({html});\n        (props.onBlur || noop)(e, html);\n      },\n      onPaste: e => {\n        e.persist();\n        if(props.noPaste) e.preventDefault();\n        (props.onPaste || noop)(e);\n        setTimeout(() => {\n          let html = this.text(), \n              max = props['data-max'] || DATA_MAX;\n          if(!props.disableMax && html.length > max) {\n            html = html.substring(0, max);\n            this.setState({ html });\n          }\n          (props.onInput || props.onKeyPress || noop)(e, html);\n        }, 1)\n      },\n      onKeyPress: e => {\n        e.persist();\n        const html = e.target.innerText || e.target.textContent;\n        if(props.whitelist && e.key && !props.whitelist.includes(e.key.toLowerCase())) e.preventDefault();\n        if(!props.allowNewLine && isEnter(e)) {\n          e.preventDefault();\n          if(!props.disableEnter) e.target.blur();\n        }\n        if(!props.disableMax && html.length > (props['data-max'] || DATA_MAX) && !isBackspace(e)) return e.preventDefault();\n        if(props.onInput || props.onKeyUp) (props.onKeyPress || noop)(e, html);\n      },\n    }\n\n    if(props.tag === 'span') return <span {...TagProps} />;\n    return <div {...TagProps} />;\n  }\n}\n","import React from 'react';\n\nexport const daterange = (\n  <svg width=\"837pt\" height=\"853pt\" viewBox=\"0 0 837 853\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g>\n      <path d=\" M 192.91 0.00 L 226.04 0.00 C 233.74 0.70 241.35 3.63 247.11 8.84 C 253.02 15.06 257.33 23.25 257.15 32.01 C 257.30 73.35 257.15 114.70 257.23 156.04 C 257.21 159.98 257.23 163.96 256.44 167.83 C 254.48 176.39 249.08 184.18 241.49 188.68 C 234.51 193.04 225.99 193.37 218.00 193.22 C 208.63 193.02 199.23 193.61 189.88 192.88 C 179.88 192.12 170.65 186.04 165.47 177.54 C 161.90 171.73 160.87 164.77 160.78 158.06 C 160.80 117.04 160.79 76.01 160.78 34.99 C 160.87 27.82 162.11 20.32 166.38 14.37 C 172.20 5.61 182.57 0.60 192.91 0.00 Z\" />\n      <path d=\" M 609.64 0.00 L 643.63 0.00 C 653.92 0.64 664.28 5.57 669.99 14.38 C 674.43 20.25 675.63 27.83 675.70 35.02 C 675.68 76.33 675.71 117.65 675.69 158.97 C 675.72 166.02 673.77 173.08 670.01 179.05 C 664.43 187.28 654.94 192.66 644.98 193.03 C 635.01 193.47 625.01 193.07 615.03 193.23 C 606.82 193.37 598.16 191.77 591.69 186.38 C 583.46 180.40 579.18 170.05 579.32 160.04 C 579.30 117.69 579.29 75.34 579.33 32.99 C 579.15 26.05 581.35 19.16 585.43 13.55 C 590.78 5.52 600.31 1.21 609.64 0.00 Z\" />\n      <path d=\" M 41.73 84.82 C 49.68 81.39 58.42 80.71 66.97 80.54 C 87.55 80.51 108.14 80.62 128.73 80.49 C 128.66 107.31 128.69 134.14 128.71 160.96 C 128.61 174.29 132.85 187.60 140.70 198.38 C 150.47 212.31 166.15 221.89 182.94 224.50 C 190.58 225.72 198.34 225.19 206.04 225.31 C 214.36 225.19 222.70 225.57 231.02 225.03 C 244.40 224.00 257.13 218.23 267.37 209.68 C 280.89 197.75 289.49 180.14 289.52 162.01 C 289.53 134.83 289.63 107.65 289.46 80.46 C 375.29 80.64 461.12 80.51 546.94 80.53 C 546.95 107.37 546.93 134.20 546.96 161.03 C 546.95 170.62 549.01 180.23 553.28 188.84 C 561.33 205.84 577.30 218.72 595.48 223.35 C 605.44 226.01 615.81 225.17 626.00 225.30 C 638.12 225.13 650.55 226.29 662.29 222.55 C 673.94 218.75 684.81 212.04 692.68 202.55 C 701.99 191.19 707.75 176.76 707.76 161.99 C 707.80 134.84 707.81 107.68 707.75 80.53 C 726.17 80.56 744.58 80.54 762.99 80.54 C 772.82 80.47 782.91 80.57 792.31 83.83 C 815.53 91.07 833.13 112.97 835.97 137.01 C 836.61 142.31 836.43 147.67 836.46 153.00 C 836.45 359.33 836.46 565.65 836.45 771.98 C 836.34 784.21 837.37 796.80 833.27 808.57 C 828.30 822.80 818.54 835.52 805.58 843.37 C 795.90 849.53 784.55 852.29 773.19 853.00 L 65.51 853.00 C 56.56 852.45 47.40 851.49 39.17 847.63 C 17.91 838.67 1.91 817.35 0.54 794.15 L 0.00 798.28 L 0.00 140.22 C 2.07 115.95 18.48 92.91 41.73 84.82 M 59.44 338.69 C 53.10 340.91 48.00 347.05 48.24 353.97 C 48.18 498.65 48.22 643.33 48.22 788.00 C 47.68 796.96 55.98 805.12 64.91 804.54 C 300.29 804.55 535.67 804.54 771.04 804.55 C 780.08 805.18 788.87 797.25 788.30 788.02 C 788.32 643.68 788.30 499.34 788.31 355.00 C 788.84 347.39 783.27 340.07 775.90 338.35 C 772.32 337.70 768.67 337.99 765.06 337.94 C 534.02 337.95 302.98 337.94 71.94 337.94 C 67.78 338.04 63.50 337.53 59.44 338.69 Z\" />\n      <path d=\" M 292.12 461.75 C 294.91 459.55 298.51 457.17 302.20 458.46 C 305.20 460.13 305.32 464.04 305.43 467.08 C 305.49 488.41 305.44 509.74 305.46 531.06 C 380.57 531.04 455.68 531.06 530.79 531.06 C 530.79 510.02 530.78 488.99 530.79 467.96 C 530.73 464.47 531.22 460.40 534.44 458.36 C 538.94 457.14 542.86 460.46 546.07 463.14 C 584.87 495.55 623.74 527.88 662.44 560.41 C 666.28 563.31 669.10 567.99 668.17 572.95 C 667.79 576.51 665.63 579.53 662.92 581.73 C 624.11 613.97 585.33 646.26 546.62 678.62 C 543.22 681.54 539.54 684.96 534.69 684.54 C 531.61 682.32 530.64 678.60 530.80 674.97 C 530.79 653.78 530.75 632.59 530.82 611.39 C 471.89 611.54 412.95 611.41 354.02 611.45 C 337.79 611.38 321.56 611.61 305.34 611.34 C 305.62 632.20 305.36 653.08 305.47 673.95 C 305.29 677.49 305.72 682.28 301.89 684.08 C 298.41 685.39 294.99 682.82 292.40 680.72 C 252.84 647.64 213.18 614.66 173.54 581.67 C 169.40 578.60 167.29 573.15 168.43 568.12 C 169.35 564.58 172.15 562.02 174.83 559.73 C 213.89 527.02 252.98 494.36 292.12 461.75 Z\" />\n    </g>\n  </svg>\n)\n\nexport const threedot = (\n  <svg id=\"threedot\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" viewBox=\"0 0 32.055 32.055\">\n    <g>\n      <path d=\"M3.968,12.061C1.775,12.061,0,13.835,0,16.027c0,2.192,1.773,3.967,3.968,3.967c2.189,0,3.966-1.772,3.966-3.967\n        C7.934,13.835,6.157,12.061,3.968,12.061z M16.233,12.061c-2.188,0-3.968,1.773-3.968,3.965c0,2.192,1.778,3.967,3.968,3.967\n        s3.97-1.772,3.97-3.967C20.201,13.835,18.423,12.061,16.233,12.061z M28.09,12.061c-2.192,0-3.969,1.774-3.969,3.967\n        c0,2.19,1.774,3.965,3.969,3.965c2.188,0,3.965-1.772,3.965-3.965S30.278,12.061,28.09,12.061z\"/>\n    </g>\n  </svg>\n)\n\nexport const doublearrow = (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 245.035 245.035\"  width=\"512px\" height=\"512px\">\n    <g>\n      <g>\n        <g>\n          <path d=\"M27.269,123.841l95.22-84.255l95.22,84.255c6.229,6.229,16.4,6.229,22.597,0     c6.293-6.229,6.293-16.336,0.064-22.597L134.027,7.2c-3.178-3.178-7.342-4.704-11.505-4.64c-4.195-0.064-8.359,1.462-11.537,4.64     L4.672,101.244c-6.229,6.229-6.229,16.368,0,22.597S21.04,130.071,27.269,123.841z\" fill=\"#FFFFFF\"/>\n          <path d=\"M134.027,121.172c-3.178-3.178-7.342-4.704-11.505-4.64c-4.195-0.064-8.359,1.462-11.537,4.64     L4.672,215.184c-6.229,6.261-6.229,16.4,0,22.597c6.229,6.261,16.368,6.261,22.597,0l95.22-84.192l95.22,84.192     c6.229,6.261,16.4,6.261,22.597,0c6.229-6.198,6.229-16.336,0-22.597L134.027,121.172z\" fill=\"#FFFFFF\"/>\n        </g>\n      </g>\n    </g>\n  </svg>\n)\n\nexport const rotatephone = (\n  <svg width=\"225pt\" height=\"225pt\" viewBox=\"0 0 225 225\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g className=\"primary\">\n      <path d=\" M 99.84 0.00 L 205.40 0.00 C 215.63 1.10 224.07 9.79 225.00 20.02 L 225.00 205.37 C 223.85 215.54 215.30 224.12 205.05 225.00 L 99.47 225.00 C 92.33 224.04 85.85 219.67 82.46 213.30 C 80.83 209.78 79.87 205.96 80.00 202.06 C 80.03 164.98 80.00 127.90 80.02 90.81 C 80.02 87.21 80.02 83.62 80.02 80.02 C 80.00 62.67 80.02 45.31 80.01 27.96 C 80.02 23.38 79.67 18.63 81.35 14.27 C 84.13 6.47 91.66 0.88 99.84 0.00 M 98.17 11.30 C 93.77 12.84 90.46 17.29 90.76 22.03 C 90.76 82.35 90.75 142.67 90.76 202.98 C 90.41 209.05 95.92 214.68 102.05 214.21 C 135.69 214.26 169.34 214.26 202.99 214.21 C 209.11 214.61 214.60 209.03 214.24 202.94 C 214.29 142.65 214.30 82.35 214.24 22.06 C 214.58 15.98 209.07 10.36 202.95 10.79 C 170.64 10.71 138.33 10.80 106.02 10.74 C 103.40 10.77 100.73 10.63 98.17 11.30 Z\" />\n      <path d=\" M 38.90 27.05 C 36.34 23.95 38.86 18.48 42.97 18.71 C 48.66 19.07 54.31 20.04 59.97 20.76 C 62.93 20.90 65.35 23.95 64.83 26.87 C 63.97 32.58 63.46 38.35 62.49 44.04 C 61.56 48.17 55.50 49.15 53.13 45.75 C 51.49 43.71 52.15 41.04 52.33 38.66 C 43.41 45.21 35.47 52.97 28.37 61.42 C 24.43 66.12 16.68 60.03 20.05 55.04 C 27.31 45.23 36.73 37.31 46.12 29.64 C 43.61 29.21 40.46 29.51 38.90 27.05 Z\" />\n      <path d=\" M 126.32 19.43 C 142.53 19.05 158.76 19.41 174.98 19.25 C 177.54 19.23 180.85 19.12 182.27 21.74 C 184.63 24.94 182.03 29.97 178.09 29.98 C 161.40 30.05 144.71 29.96 128.02 30.02 C 125.07 30.41 121.91 28.05 121.88 25.00 C 121.63 22.38 123.64 19.67 126.32 19.43 Z\" />\n      <path d=\" M 148.48 167.61 C 159.26 164.76 171.01 173.85 171.08 184.99 C 171.78 195.03 162.99 204.40 152.92 204.34 C 143.64 204.83 135.01 197.26 134.05 188.07 C 132.67 178.87 139.38 169.44 148.48 167.61 M 149.38 178.49 C 144.17 180.53 142.91 188.23 147.31 191.73 C 151.63 195.92 159.68 192.90 160.32 186.95 C 161.50 181.08 154.78 175.91 149.38 178.49 Z\" />\n    </g>\n    <g className=\"secondary\">\n      <path d=\" M 7.45 85.43 C 11.63 81.58 17.37 79.85 22.99 79.99 C 42.00 80.04 61.01 80.00 80.02 80.02 C 80.02 83.62 80.02 87.21 80.02 90.81 C 60.67 90.83 41.32 90.78 21.98 90.83 C 18.02 90.60 14.21 92.81 12.22 96.19 C 10.69 98.50 10.79 101.38 10.73 104.04 C 10.83 137.02 10.71 170.00 10.79 202.98 C 10.41 209.05 15.89 214.60 21.98 214.17 C 42.09 214.21 62.20 214.18 82.31 214.19 L 82.46 213.30 C 85.85 219.67 92.33 224.04 99.47 225.00 L 17.58 225.00 C 13.54 223.49 9.35 221.84 6.36 218.60 C 3.08 215.43 1.28 211.13 0.00 206.84 L 0.00 97.56 C 1.63 93.08 3.65 88.51 7.45 85.43 Z\" />\n      <path d=\" M 22.25 122.37 C 25.49 120.66 29.94 123.22 29.96 126.89 C 30.03 143.94 30.02 161.00 29.97 178.05 C 30.09 182.02 24.96 184.57 21.77 182.34 C 19.51 181.06 19.21 178.28 19.26 175.96 C 19.28 159.96 19.26 143.97 19.27 127.97 C 19.10 125.73 20.18 123.37 22.25 122.37 Z\" />\n    </g>\n  </svg>\n)\n\nexport const angle = (\n  <svg width=\"532pt\" height=\"532pt\" viewBox=\"0 0 532 532\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g>\n    <path d=\" M 20.53 157.47 C 31.07 150.40 44.66 147.94 56.97 151.12 C 63.64 152.56 69.51 156.21 75.14 159.90 C 138.76 200.52 202.37 241.14 265.99 281.75 C 331.04 240.21 396.10 198.69 461.16 157.15 C 465.97 153.99 471.36 151.70 477.04 150.68 C 493.47 147.13 511.49 153.85 521.88 167.00 C 527.99 174.56 531.46 184.03 532.00 193.72 L 532.00 196.99 C 531.49 209.60 525.81 221.99 516.15 230.19 C 510.80 234.69 504.64 238.05 498.84 241.91 C 429.51 286.23 360.18 330.58 290.85 374.91 C 276.23 384.61 255.76 384.65 241.15 374.91 C 168.14 328.22 95.13 281.54 22.13 234.85 C 8.90 227.24 0.54 212.36 0.00 197.21 L 0.00 192.39 C 1.30 178.55 8.64 164.97 20.53 157.47 Z\" />\n    </g>\n  </svg>\n)\n\nexport const hamburger = (\n  <svg width=\"512pt\" height=\"512pt\" viewBox=\"0 0 512 512\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g>\n      <path d=\" M 239.35 9.43 C 274.65 8.70 310.03 10.37 345.05 14.90 C 365.95 17.98 387.03 21.92 406.42 30.62 C 426.98 39.82 444.73 54.71 458.33 72.58 C 471.78 90.23 481.42 110.65 487.27 132.03 C 498.85 179.03 501.54 227.72 500.56 275.97 C 499.83 303.41 497.12 330.84 491.80 357.78 C 488.62 374.39 484.75 391.05 477.35 406.35 C 463.41 436.90 440.01 463.93 409.35 478.45 C 389.47 488.01 367.50 491.91 345.87 495.21 C 297.39 501.60 248.24 502.80 199.48 499.21 C 172.34 497.00 145.02 494.04 118.90 486.04 C 95.99 479.06 75.03 465.85 58.98 448.05 C 38.37 425.45 24.37 396.93 18.63 366.91 C 11.03 331.83 7.98 295.86 7.75 260.00 C 7.03 220.81 10.20 181.45 18.57 143.12 C 24.72 113.24 38.56 84.78 59.13 62.18 C 73.64 46.23 92.08 33.91 112.37 26.63 C 135.49 18.72 159.83 15.35 184.03 12.77 C 202.42 10.98 220.88 9.83 239.35 9.43 M 227.17 42.18 C 200.23 43.37 173.25 45.58 146.77 50.83 C 132.87 53.66 118.87 57.37 106.59 64.71 C 83.70 78.31 66.98 100.70 57.28 125.23 C 51.77 137.89 49.51 151.61 46.88 165.07 C 41.44 195.72 39.58 226.90 39.94 258.00 C 39.71 296.02 43.23 334.23 52.50 371.16 C 58.45 391.38 68.48 410.56 82.72 426.19 C 94.93 439.52 110.52 449.99 127.99 454.97 C 145.33 460.01 163.24 462.80 181.16 464.83 C 231.96 470.42 283.39 470.19 334.13 464.05 C 353.15 461.45 372.43 458.61 390.35 451.44 C 411.54 442.71 428.71 425.98 440.50 406.57 C 448.75 392.79 455.16 377.74 458.18 361.92 C 468.50 316.73 469.55 270.07 467.95 223.94 C 466.54 195.04 462.77 166.20 455.62 138.14 C 446.82 108.68 428.85 80.89 402.09 64.87 C 389.03 56.96 374.01 53.33 359.19 50.39 C 347.93 48.22 336.56 46.61 325.16 45.40 C 292.63 42.03 259.85 40.71 227.17 42.18 Z\" />\n      <path d=\" M 150.50 147.67 C 152.28 147.11 154.15 146.96 156.00 146.92 C 221.33 146.93 286.65 146.95 351.98 146.92 C 358.92 146.76 365.83 151.08 368.35 157.63 C 371.31 164.63 369.20 173.47 363.08 178.10 C 359.97 180.59 355.98 181.82 352.01 181.76 C 288.67 181.79 225.33 181.75 161.99 181.78 C 158.29 181.73 154.48 182.10 150.86 181.06 C 143.85 179.07 138.46 172.37 138.25 165.05 C 137.72 157.34 143.11 149.83 150.50 147.67 Z\" />\n      <path d=\" M 153.43 236.70 C 219.61 236.33 285.82 236.65 352.02 236.54 C 361.94 235.86 370.64 245.35 369.62 255.12 C 369.31 264.11 361.05 271.69 352.09 271.36 C 286.72 271.36 221.36 271.38 156.00 271.35 C 147.60 271.76 139.60 265.18 138.47 256.84 C 136.63 247.46 143.85 237.54 153.43 236.70 Z\" />\n      <path d=\" M 150.31 329.48 C 153.42 328.49 156.72 328.71 159.94 328.70 C 224.28 328.70 288.63 328.70 352.97 328.69 C 357.93 328.78 362.79 331.11 365.96 334.93 C 371.39 341.45 370.86 351.98 365.00 358.06 C 361.74 361.60 356.96 363.64 352.14 363.52 C 289.10 363.52 226.06 363.53 163.01 363.52 C 157.55 363.50 151.64 364.20 146.77 361.14 C 139.34 357.04 136.24 347.11 139.52 339.38 C 141.44 334.72 145.50 330.99 150.31 329.48 Z\" />\n    </g>\n  </svg>\n)\n\nexport const search = (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"136pt\" version=\"1.1\" viewBox=\"-1 0 136 136.21852\" width=\"136pt\">\n    <g>\n      <path d=\"M 93.148438 80.832031 C 109.5 57.742188 104.03125 25.769531 80.941406 9.421875 C 57.851562 -6.925781 25.878906 -1.460938 9.53125 21.632812 C -6.816406 44.722656 -1.351562 76.691406 21.742188 93.039062 C 38.222656 104.707031 60.011719 105.605469 77.394531 95.339844 L 115.164062 132.882812 C 119.242188 137.175781 126.027344 137.347656 130.320312 133.269531 C 134.613281 129.195312 134.785156 122.410156 130.710938 118.117188 C 130.582031 117.980469 130.457031 117.855469 130.320312 117.726562 Z M 51.308594 84.332031 C 33.0625 84.335938 18.269531 69.554688 18.257812 51.308594 C 18.253906 33.0625 33.035156 18.269531 51.285156 18.261719 C 69.507812 18.253906 84.292969 33.011719 84.328125 51.234375 C 84.359375 69.484375 69.585938 84.300781 51.332031 84.332031 C 51.324219 84.332031 51.320312 84.332031 51.308594 84.332031 Z M 51.308594 84.332031 \" />\n    </g>\n  </svg>\n)\n\nexport const thinsearch = (\n  <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512.005 512.005\">\n    <g>\n      <g>\n        <path d=\"M505.749,475.587l-145.6-145.6c28.203-34.837,45.184-79.104,45.184-127.317c0-111.744-90.923-202.667-202.667-202.667\n          S0,90.925,0,202.669s90.923,202.667,202.667,202.667c48.213,0,92.48-16.981,127.317-45.184l145.6,145.6\n          c4.16,4.16,9.621,6.251,15.083,6.251s10.923-2.091,15.083-6.251C514.091,497.411,514.091,483.928,505.749,475.587z\n           M202.667,362.669c-88.235,0-160-71.765-160-160s71.765-160,160-160s160,71.765,160,160S290.901,362.669,202.667,362.669z\"/>\n      </g>\n    </g>\n  </svg>\n)\n\nexport const arrow = (\n  <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" width=\"123.964px\" height=\"123.964px\" viewBox=\"0 0 123.964 123.964\">\n    <g>\n      <path d=\"M121.7,57.681L83,26.881c-4-3.1-10-0.3-10,4.8v10.3c0,3.3-2.2,6.2-5.5,6.2H6c-3.3,0-6,2.4-6,5.8v16.2c0,3.2,2.7,6,6,6h61.5\n        c3.3,0,5.5,2.601,5.5,5.9v10.3c0,5,6,7.8,9.9,4.7l38.6-30C124.7,64.781,124.8,60.081,121.7,57.681z\"/>\n    </g>\n  </svg>\n)\n\nexport const history = (\n  <svg height=\"512\" viewBox=\"0 0 512 512\" width=\"512\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g>\n      <path d=\"m276 138v109.716l72.809 72.809c7.811 7.811 7.811 20.474 0 28.284-7.811 7.811-20.474 7.81-28.284 0l-78.667-78.667c-3.751-3.75-5.858-8.838-5.858-14.142v-118c0-11.046 8.954-20 20-20s20 8.954 20 20zm58.667-138h-157.334c-41.89 0-83.217 14.722-116.284 43.478v-23.478c0-11.046-8.954-20-20-20s-20 8.954-20 20v78.667c0 11.046 9.031 20 20 20h78.667c11.046 0 20-8.954 20-20s-8.954-20-20-20h-37.833c25.314-24.405 59.485-38.667 95.45-38.667h157.333c75.727 0 137.334 61.607 137.334 137.333v157.333c0 75.727-61.607 137.334-137.333 137.334h-157.334c-75.726 0-137.333-61.607-137.333-137.333v-78.667c0-11.046-8.954-20-20-20s-20 8.954-20 20v78.667c0 97.782 79.551 177.333 177.333 177.333h157.333c97.783 0 177.334-79.551 177.334-177.333v-157.334c0-97.782-79.551-177.333-177.333-177.333z\"/>\n    </g>\n  </svg>\n)","import React, { Component } from 'react';\nimport moment from 'moment';\nimport {\n  pagePos,\n  frmt,\n  debounce\n} from '../utils'\nimport {\n  doublearrow\n} from '../utils/icons';\n\nrequire('./DateScrubber.css');\n\nconst SCRUBBER_TICK = 2;\nconst SCRUBBER_RANGE = 90;\nconst WEEKDAY = date => date.day() && date.day() < 6;\n\nexport default class DateScrubber extends Component {\n  state = {\n    scrubberEnd: this.props.lastDay,\n  }\n  meta = {}\n\n  componentWillMount = () => {\n    window.addEventListener('resize', this.handleResize);\n    window.addEventListener('keydown', this.handleKey);\n  }\n\n  componentDidMount = () => {\n    this.drawScrubber();\n  }\n\n  componentDidUpdate = prevProps => {\n    // update render state based on parent header state\n    if(prevProps.headerIndex !== this.props.headerIndex && this.props.headerIndex === 1) {\n      this.meta.weekdays = null;\n      this.setState({\n        scrubberEnd: this.meta.activeScrubberEnd || this.props.lastDay\n      }, this.drawScrubber);\n    }\n  }\n\n  componentWillUnmount = () => {\n    window.removeEventListener('resize', this.handleResize);\n    window.removeEventListener('keydown', this.handleKey);\n  }\n\n  handleResize = e => {\n    this.meta.canvas = null;\n    setTimeout(() => {\n      if(!this.meta.canvas) this.drawScrubber();\n    }, 50)\n  }\n\n  drawScrubber = () => {\n    if(this.props.headerIndex !== 1) return;\n    const { canvas } = this.refs, rect = canvas.getBoundingClientRect();\n    // init canvas if initial render \n    const setupCanvas = () => {\n      const dpr = window.devicePixelRatio || 1;\n      canvas.width = rect.width * dpr;\n      canvas.height = rect.height * dpr;\n      this.meta.canvas = canvas.getContext('2d');\n      this.meta.canvas.scale(dpr, dpr);\n      return this.meta.canvas;\n    }\n    const setupTicks = () => {\n      const weekdays = [];\n      const time = this.state.scrubberEnd.clone();\n      while(weekdays.length < SCRUBBER_RANGE && time.isSameOrAfter(moment(this.props.data.meta.start_date, 'L'), 'days')) {\n        if(WEEKDAY(time)) weekdays.unshift(time.format('L'));\n        time.subtract(1, 'days');\n      }\n      this.meta.weekdays = weekdays;\n      this.forceUpdate();\n      return weekdays;\n    }\n\n    // if weekdays have not been initialized or year changed\n    const weekdays = this.meta.weekdays || setupTicks();\n    // draw calendar\n    const ctx = this.meta.canvas || setupCanvas();\n    ctx.clearRect(0,0,canvas.width,canvas.height);\n    const distance = this.calcTickDistance();\n    const offset = SCRUBBER_TICK; // first one gets drawn in half\n    weekdays.forEach((day, i) => {\n      ctx.lineWidth = SCRUBBER_TICK;\n      ctx.beginPath();\n\n      const dates = this.meta.propActiveDates || this.props.activeDates;\n      if(i === this.meta.canvasHighlight || [dates[0].format('L'), dates[1].format('L')].includes(day)) {\n        ctx.strokeStyle = '#fff'\n        ctx.moveTo(distance * i + offset, rect.height * .25);\n        ctx.lineTo(distance * i + offset, rect.height);\n      } else if(moment(day, 'L').isBetween(dates[0], dates[1])) {\n        ctx.strokeStyle = 'rgba(255,255,255,0.5)';\n        ctx.moveTo(distance * i + offset, rect.height * .25);\n        ctx.lineTo(distance * i + offset, rect.height * .75);\n      } else {\n        ctx.strokeStyle = 'rgba(255,255,255,0.2)';\n        ctx.moveTo(distance * i + offset, rect.height * .25);\n        ctx.lineTo(distance * i + offset, rect.height * .75);\n      }\n      ctx.stroke();\n    })\n  }\n\n  calcTickDistance = () => {\n    const days = this.meta.weekdays.length;\n    const { canvas } = this.refs, rect = canvas.getBoundingClientRect();\n    let distance = rect.width / days;\n    // recalc width to get rid of empty space at back\n    const calcWidth = rect.width + distance - (SCRUBBER_TICK * 2);\n    return calcWidth / days;\n  }\n\n  scrub = e => {\n    // calc hover highlight\n    const { canvas, dates } = this.refs;\n    let callback, delay = 150;\n\n    if(e.target === canvas && e.type !== 'mouseleave') {\n      const distance = this.calcTickDistance(), \n            offset = SCRUBBER_TICK * .5,\n            canvasPos = pagePos(canvas);\n      canvasPos.y = canvasPos.y - this.refs.container.clientHeight;\n      const highlight = Math.min(\n        Math.floor((e.pageX - canvasPos.x + offset) / distance), \n        this.meta.weekdays.length - 1\n      );\n\n      const day = moment(this.meta.weekdays[highlight], 'L');\n      dates.innerHTML = this.renderDates([day, day]);\n\n      if(this.meta.canvasHighlight === highlight) return;\n      if(!this.meta.propActiveDates) {\n        this.meta.propActiveDates = this.props.activeDates;\n        this.meta.propActiveDateOpt = this.props.activeDateOpt;\n      }\n      callback = () => this.props.onDateChange('range', [day, day]);\n\n      this.meta.canvasHighlight = highlight;\n      this.drawScrubber();\n    }\n    else if(this.meta.canvasHighlight > -1) {\n      this.meta.canvasHighlight = -1;\n      this.drawScrubber();\n      const { propActiveDateOpt, propActiveDates } = this.meta;\n      dates.innerHTML = this.renderDates(propActiveDates);\n      if(propActiveDateOpt > -1) {\n        callback = () => this.props.onDateChange('opt', propActiveDateOpt);\n      } else {\n        callback = () => this.props.onDateChange('range', propActiveDates);\n      }\n      delay = 0;\n      this.meta.propActiveDateOpt = -1;\n      this.meta.propActiveDates = null;\n    }\n\n    if(callback) debounce(callback, delay, 'date-scrubber');\n  }\n\n  scrubSelect = e => {\n    const selectedDate = moment(this.meta.weekdays[this.meta.canvasHighlight], 'L');\n    const dates = this.meta.propActiveDates;\n    if(dates[0] === dates[1] && selectedDate.format('L') === dates[0].format('L')) return;\n    if(dates[0] === dates[1]) {\n      // put the earlier date first\n      if(dates[0].isBefore(selectedDate)) {\n        this.meta.propActiveDates = [dates[0], selectedDate];\n        this.meta.activeScrubberEnd = this.state.scrubberEnd;\n      }\n      else this.meta.propActiveDates = [selectedDate, dates[0]];\n    }\n    else {\n      this.meta.propActiveDates = [selectedDate, selectedDate];\n      this.meta.activeScrubberEnd = this.state.scrubberEnd;\n    }\n    this.meta.propActiveDateOpt = -1;\n    this.props.onDateChange('range', this.meta.propActiveDates);\n    this.drawScrubber();\n  }\n\n  scrubAdjust = e => {\n    this.meta.weekdays = null;\n    let end = moment(this.state.scrubberEnd.format('L'), 'L'); // trims time\n    const mod = e.currentTarget === this.refs.scrubBackwards ? -1 : 1;\n    let diff = 0;\n    // shift by RANGE or (if upward) until last day\n    while(diff < SCRUBBER_RANGE-1 && end[mod < 0 ? 'isSameOrBefore' : 'isBefore'](this.props.lastDay, 'days')) {\n      if(WEEKDAY(end)) diff++;\n      end.add(mod, 'days');\n    }\n    // if backwards and before start_date, shift back up to fit RANGE\n    if(mod < 0) {\n      let ticks = 0;\n      const start = end.clone();\n      while(ticks < SCRUBBER_RANGE && start.isSameOrAfter(moment(this.props.data.meta.start_date, 'L'), 'days')) {\n        if(WEEKDAY(start)) ticks++;\n        start.subtract(1, 'days');\n      }\n      if(ticks < SCRUBBER_RANGE) { // start date was hit\n        diff = 0;\n        end = moment(this.props.data.meta.start_date, 'L');\n        // shift by RANGE or (if upward) until last day\n        while(diff < SCRUBBER_RANGE-1 && end.isSameOrBefore(this.props.lastDay, 'days')) {\n          if(WEEKDAY(end)) diff++;\n          end.add(1, 'days');\n        }\n      }\n    }\n    this.setState({ scrubberEnd: end }, this.drawScrubber)\n  }\n\n  renderDates = override => {\n    const dates = (override || this.props.activeDates);\n    const fmt = frmt(dates[0], dates[1]);\n    if(fmt[0] === fmt[1]) return fmt[0];\n    return `${fmt[0]} - ${fmt[1]}`;\n  }\n\n  render = () => {\n    const {\n      weekdays // hover\n    } = this.meta;\n\n    return (\n      <div ref=\"container\" className=\"scrubber-container\" onMouseMove={this.scrub} onMouseLeave={this.scrub}>\n        <div className=\"scrubber\">\n          <div className=\"dates\" ref=\"dates\">{ this.renderDates() }</div>\n          <canvas ref=\"canvas\" onClick={this.scrubSelect} />\n          <div \n            className={`arrow backwards ${weekdays && weekdays[0] === this.props.data.meta.start_date ? 'disabled' : ''}`} \n            ref=\"scrubBackwards\" \n            onClick={this.scrubAdjust}\n          >\n            <span className=\"clickitem\">{doublearrow}</span>\n          </div>\n          <div \n            className={`arrow forwards ${weekdays && weekdays[weekdays.length-1] === this.props.lastDay.format('L') ? 'disabled' : ''}`} \n            ref=\"scrubForwards\" \n            onClick={this.scrubAdjust}\n          >\n            <span className=\"clickitem\">{doublearrow}</span>\n          </div>\n          {\n            !weekdays ? null : [\n              <div key=\"from\" className=\"from\">{frmt(moment(weekdays[0], 'L'), moment(weekdays[weekdays.length-1], 'L'))[0]}</div>,\n              <div key=\"to\" className=\"to\">{frmt(moment(weekdays[0], 'L'), moment(weekdays[weekdays.length-1], 'L'))[1]}</div>\n            ]\n          }\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport moment from 'moment';\nimport { Line } from 'react-chartjs-2';\nimport 'chartjs-plugin-annotation';\n// https://github.com/abelheinsbroek/chartjs-plugin-crosshair\n// import 'chartjs-plugin-crosshair';\nimport 'chartjs-plugin-style';\nimport { \n  formatMoney, \n  frmt, \n  round,\n  constrain,\n  getLatest,\n  colorMap,\n  getColorProperties,\n  shouldUpdate,\n} from '../utils';\n\nrequire('./Portfolio.css');\n\nexport default class Portfolio extends Component {\n  state = {};\n  meta = {}\n\n  componentDidMount = () => {\n    this.calcData();\n    if(this.refs.chart) {\n      this.refs.chart.addEventListener('touchmove', e => e.stopPropagation(), { passive: false });\n    }\n  }\n\n  shouldComponentUpdate = shouldUpdate.bind(this, this)\n\n  componentDidUpdate = prevProps => {\n    // check if data changed\n    let dataChanged = false;\n    if(prevProps.data !== this.props.data) dataChanged = true;\n    if(prevProps.dataView !== this.props.dataView) dataChanged = true;\n    if(prevProps.feeAdjustments !== this.props.feeAdjustments) dataChanged = true;\n    if(prevProps.contributionAdjustments !== this.props.contributionAdjustments) dataChanged = true;\n    if(dataChanged) this.calcData();\n  }\n\n  calcData = () => {\n    const { history, activeDates, data, dataView, mobile } = this.props;\n\n    if(activeDates[0].isSame(activeDates[1])) return;\n    // all dates (strings)\n    const datesKeys = Object.keys(data).filter(key => key !== 'meta' && data[key]);\n    // profit/loss type key \n    const valKey = dataView === '$' ? 'balance' : 'plPerc';\n    // check if chart ends higher than it began\n    const isGain = data[datesKeys[0]].adj[valKey] < data[datesKeys[datesKeys.length - 1]].adj[valKey];\n    // check if color should be positive or negative\n    const color = isGain ? colorMap.conservative : colorMap.other,\n          colorProps = getColorProperties(color);\n    // calc min and max vals for chart\n    let min = datesKeys.reduce((min, date) => Math.min(min, data[date].adj[valKey]), data[datesKeys[0]].adj[valKey]),\n        max = datesKeys.reduce((max, date) => Math.max(max, data[date].adj[valKey]), data[datesKeys[0]].adj[valKey]);\n    min = min - (Math.abs(max - min) / 10)\n    max = max + (Math.abs(max - min) / 10);\n\n    const chartData = {\n      labels: datesKeys,\n      datasets: [\n        {\n          outerGlowColor: colorProps.rgbStr(colorProps.r, colorProps.g, colorProps.b, .5),\n          outerGlowWidth: 5,\n          data: datesKeys.map(key => data[key].adj[valKey])\n        }\n      ]\n    }\n\n    let lineTension = 0.4,\n        pointRadius = 1;\n    if(datesKeys.length > 200) {\n      lineTension = 0.25;\n      pointRadius = 0;\n    }\n    if(datesKeys.length > 400) {\n      lineTension = 0.01;\n    }\n\n    const chartOptions = {\n      responsive: true,\n      maintainAspectRatio: false,\n      legend: false,\n      events: ['mousemove', 'mouseout', 'click', 'touchstart', 'touchmove', 'touchend'],\n      elements: {\n        line: {\n          tension: lineTension,\n          borderCapStyle: 'round',\n          fill: false,\n          borderColor: color,\n          borderWidth: 3,\n          borderDash: [],\n          borderDashOffset: 0.0,\n          borderJoinStyle: 'miter',\n        },\n        point: {\n          radius: pointRadius,\n          backgroundColor: 'white',\n          borderColor: 'rgba(0,0,0,0)',\n          hoverBorderColor: 'rgba(0,0,0,0)',\n          hoverBackgroundColor: 'white',\n        }\n      },\n      annotation: {\n        annotations: [{\n          type: 'line',\n          mode: 'horizontal',\n          scaleID: 'y-axis-0',\n          value: 0,\n          // borderDash: [20, 5],\n          borderColor: 'hsla(220, 39%, 65%, .3)',\n          borderWidth: 2,\n          drawTime: 'beforeDatasetsDraw',\n          // label: {\n          //   enabled: true,\n          //   content: '0',\n          //   backgroundColor: 'hsla(220, 39%, 65%, .3)',\n          //   font: {\n          //     // color: 'hsla(220, 39%, 80%, .8)'\n          //     size: 25,\n          //     color: 'red'\n          //   }\n          //   // format label: https://github.com/chartjs/chartjs-plugin-annotation\n          // }\n        }]\n      },\n      layout: {\n        padding: 10\n      },\n      scales: {\n        yAxes: [{\n          gridLines: {\n            display: false,\n            drawBorder: false,\n          },\n          ticks: { min, max },\n          scaleID: 'y-axis-0',\n          display: false\n        }],\n        xAxes: [{\n          gridLines: {\n            display: false,\n            drawBorder: false,\n          },\n          display: false\n        }]\n      },\n      hover: {\n        intersect: false,\n        mode: 'index',\n        animationDuration: 0.01\n      },\n      // plugins: {\n      //   crosshair: {\n      //     snap: {\n      //       enabled: true\n      //     },\n      //   },\n      // },\n      tooltips: {\n        enabled: false, // Disable the on-canvas tooltip\n        intersect: false, // Prevent need for mouse to touch the line\n        mode: 'index',\n        custom: function(context) {\n          // Tooltip Element\n          var tooltipEl = document.getElementById('chartjs-tooltip');\n\n          // Create element on first render\n          if (!tooltipEl) {\n            tooltipEl = document.createElement('div');\n            tooltipEl.classList.add('portfolio-tooltip')\n            tooltipEl.id = 'chartjs-tooltip';\n            tooltipEl.innerHTML = '<section></section>';\n            document.body.appendChild(tooltipEl);\n          }\n\n          // Hide if no tooltip\n          if (context.opacity === 0) {\n            tooltipEl.style.opacity = 0;\n            return;\n          }\n\n          // Set caret Position\n          tooltipEl.classList.remove('above', 'below', 'no-transform');\n          if (context.yAlign) {\n            tooltipEl.classList.add(context.yAlign);\n          } else {\n            tooltipEl.classList.add('no-transform');\n          }\n\n          // Set Text\n          if(context.body) {\n            let innerHtml = '';\n            (context.title || []).forEach(function(title) {\n                innerHtml += '<div class=\"title\">' + frmt(moment(title, 'L')) + '</div>';\n            });\n\n            context.body.map(b => b.lines).forEach(function(body, i) {\n              const val = body[0]\n              if(dataView === '$') innerHtml += `<div class=\"value\">$${formatMoney(val)}</div>`;\n              if(dataView === '%') innerHtml += `<div class=\"value\">${round(val, Math.abs(val) < 1 ? 2 : Math.abs(val) < 10 ? 1 : 0)}%</div>`;\n            });\n\n            tooltipEl.querySelector('section').innerHTML = innerHtml;\n          }\n\n          const canvas = document.getElementById('portfolio').querySelector('canvas');\n          let position = {}\n          if(canvas) position = canvas.getBoundingClientRect();\n\n          // Display, position, and set styles for font\n          tooltipEl.style.opacity = 1;\n          let left, top;\n          // normal screen, below and to the left\n          if(!mobile && window.innerWidth > 767) {\n            const offset = 25;\n            left = (position.left || 0) + window.pageXOffset + context.caretX + offset;\n            top = (position.top || 0) + window.pageYOffset + context.caretY + offset;\n          }\n          // mobile screen, above and centered\n          else {\n            const offset = 25;\n            const tooltipRect = tooltipEl.getBoundingClientRect();\n            top = (position.top || 0) - tooltipRect.height;\n            if(!mobile && top < 70) top = position.top + position.height;\n            left = constrain(\n              (position.left || 0) + window.pageXOffset + context.caretX - (tooltipRect.width / 2),\n              15,\n              window.innerWidth - 15 - tooltipRect.width\n            );\n          }\n          // do not let the tooltip overflow off the page\n\n          tooltipEl.style.left = constrain(left, 15, window.innerWidth - 15) + 'px';\n          tooltipEl.style.top = top + 'px';\n        }\n      }\n    }\n\n    this.setState({\n      chartData: chartData,\n      chartOptions: chartOptions,\n    })\n  }\n\n  render = () => {\n    const { chartData, chartOptions } = this.state;\n\n    return (\n      <div className=\"tile-container\" id=\"portfolio\">\n        <div className=\"tile\">\n          <div className=\"header\">\n            <div className=\"title\">Portfolio</div>\n          </div>\n          <div className=\"body\">\n            <div className=\"chart-wrapper\" ref=\"chart\">\n              {\n                chartData && chartOptions &&\n                <Line data={chartData} options={chartOptions} />\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\nimport anime from 'animejs';\nimport moment from 'moment';\nimport { \n  round, \n  getNumberProperties, \n  getColorProperties, \n  glow,\n  colorMap,\n  makeDoubleDecimal,\n  formatMoney,\n  getLatest,\n  shouldUpdate\n} from '../utils';\nimport { \n  threedot,\n} from '../utils/icons';\n\nrequire('./Balances.css');\n\nexport default class Balances extends Component {\n  state = {};\n  meta = {}\n\n  shouldComponentUpdate = shouldUpdate.bind(this, this)\n\n  componentDidUpdate = prevProps => {\n    const { balance, ytd, pl } = this.refs;\n    // set initial data vals\n    document.getElementById('balances').querySelectorAll('[data-val]').forEach(el => {\n      if(getNumberProperties(el.getAttribute('data-val')).valid) return;\n      el.setAttribute('data-val', el.textContent);\n    })\n\n    // ANIMATE TRANSITIONS\n    if(this.state.showData || prevProps.mobile || !this.props.allowAnimations) return;\n    const old = getLatest(prevProps.data, prevProps.activeDates[1]).data,\n          latest = getLatest(this.props.data, this.props.activeDates[1]).data,\n          perc = this.props.dataView === '%';\n          \n    let shouldAnimate = false;\n    if(old.adj.balance !== latest.adj.balance) shouldAnimate = true;\n    if(old.ytd_contributions !== latest.ytd_contributions) shouldAnimate = true;\n    if(old.adj.pl !== latest.adj.pl) shouldAnimate = true;\n    if(prevProps.feeAdjustments !== this.props.feeAdjustments) shouldAnimate = true;\n    if(prevProps.contributionAdjustments !== this.props.contributionAdjustments) shouldAnimate = true;\n    if(shouldAnimate) {\n      const anim = {\n        balance_from: getNumberProperties([...balance.querySelectorAll('[data-val]')].map(el => el.getAttribute('data-val')).join('.')).value,\n        ytd_from: getNumberProperties(ytd.querySelector('[data-val]').getAttribute('data-val')).value,\n        pl_from: getNumberProperties([...pl.querySelectorAll('[data-val]')].map(el => el.getAttribute('data-val')).join('.')).value,\n      }\n      const ytdxx = getNumberProperties(round(latest.ytd_contributions, 2)),\n          maxxx = getNumberProperties(round(this.getMaxContributions(this.props.activeDates[1]), 2)),\n          ytdRange = 100 * ytdxx.value / maxxx.value,\n          ytdPerc = round(ytdRange, 0);\n      if(this.meta.valAnims) this.meta.valAnims.pause();\n      this.meta.valAnims = anime({\n        targets: anim, \n        balance_from: latest.adj.balance,\n        ytd_from: perc ? round(100 * latest.ytd_contributions / this.getMaxContributions(this.props.activeDates[1]), 0) \n                  : latest.ytd_contributions,\n        pl_from: perc ? latest.adj.plPerc : latest.adj.pl,\n        easing: 'easeOutExpo',\n        // round: 2,\n        duration: 1000,\n        update: () => {\n          if(this.props.dataView !== prevProps.dataView) return;\n          if(anim.balance_from_history !== anim.balance_from) {\n            const valEls = balance.querySelectorAll('[data-val]');\n            const num = makeDoubleDecimal(getNumberProperties(round(anim.balance_from, 2)));\n            num.comma.split('.').forEach((n, i) => { \n              valEls[i].innerHTML = n;\n              valEls[i].setAttribute('data-val', n);\n            });\n          }\n          if(anim.ytd_from_history !== anim.ytd_from) {\n            const num = getNumberProperties(round(anim.ytd_from, 0));\n            ytd.querySelector('[data-val]').innerHTML = num.comma;\n            ytd.querySelector('[data-val]').setAttribute('data-val', num.comma)\n          }\n          if(anim.pl_from_history !== anim.pl_from) {\n            if(perc) {\n              let num = round(anim.pl_from, 2);\n              if(Math.abs(latest.adj.plPerc) >= 1) num = round(num, 1);\n              if(Math.abs(latest.adj.plPerc) >= 10) num = round(num, 0);\n              pl.querySelector('[data-val]').innerHTML = num;\n              pl.querySelector('[data-val]').setAttribute('data-val', num)\n            } else {\n              const num = makeDoubleDecimal(getNumberProperties(round(anim.pl_from, 2)));\n              const valEls = pl.querySelectorAll('[data-val]');\n              num.comma.split('.').forEach((n, i) => { \n                valEls[i].innerHTML = n;\n                valEls[i].setAttribute('data-val', n);\n              });\n            }\n          }\n          anim.balance_from_history = anim.balance_from;\n          anim.ytd_from_history = anim.ytd_from;\n          anim.pl_from_history = anim.pl_from;\n        }\n      })\n    }\n  }\n\n  getMaxContributions = date => {\n    const list = this.props.data.meta.max_contribution;\n    let pair, year = date.year();\n    while(!pair) {\n      for(let i = 0; i < list.length; i++) {\n        if(list[i][0] === year) pair = list[i];\n      }\n      year--;\n    }\n    return pair[1];\n  }\n\n  render = () => {\n    const { data, activeDates, dataView, mobile } = this.props;\n    const { showData } = this.state;\n    const perc = dataView === '%';\n    const latest = getLatest(data, activeDates[1]).data,\n          balance = getNumberProperties(round(latest.adj.balance, 2)),\n          ytd = getNumberProperties(round(latest.ytd_contributions, 2)),\n          max = getNumberProperties(round(this.getMaxContributions(activeDates[1]), 2)),\n          ytdRange = 100 * ytd.value / max.value,\n          ytdPerc = round(ytdRange, 0),\n          vts = getNumberProperties(round(latest.vts_fees, 2)),\n          total = getNumberProperties(round(latest.adj.total_contributions + vts.value, 2)),\n          pl = getNumberProperties(round(latest.adj.pl, 2)),\n          plPerc = round(latest.adj.plPerc, \n                         Math.abs(latest.adj.plPerc) < 1 ? 2 :\n                         Math.abs(latest.adj.plPerc) < 10 ? 1 : 0),\n          plRange = 100 * Math.abs(pl.value) / (pl.value + total.value);\n    [balance,pl].map(makeDoubleDecimal);\n    let commIndex = data.meta.commission.length - 1,\n        currComm = data.meta.commission[commIndex];\n    while(moment(currComm[0],'L').isAfter(activeDates[1])) {\n      commIndex--;\n      currComm = data.meta.commission[commIndex];\n    }\n\n    const calcAge = () => {\n      const start = moment(data.meta.start_date, 'L');\n      const days = activeDates[1].diff(start, 'days'),\n            months = Math.floor(days/30, 0),\n            years = Math.floor(months/12, 0);\n      if(days <= 31) return `${days} day${days !== 1 ? 's' : ''}`;\n      if(months <= 12) return `${months} month${months !== 1 ? 's' : ''}`;\n      let text = `${years} year${years !== 1 ? 's' : ''}`;\n      if(years < 5 && months % 12 > 0) {\n        text.replace('years','yr').replace('year','yr');\n        text += `, ${months % 12} mo`;\n      }\n      return text;\n    }\n\n    return (\n      <div className=\"tile-container\" id=\"balances\">\n        <div \n          className={`tile ${showData ? 'show-data' : ''}`}\n          onClick={mobile ? e => this.setState({showData: !showData}) : null}\n        >\n          {\n            mobile ? null :\n            <div className=\"data-toggle\" onClick={e => this.setState({showData: !showData})}>{showData ? <span>+</span> : threedot}</div>\n          }\n          <div className=\"header\">\n            <div className=\"title\">Balances</div>\n          </div>\n          <div className=\"body\">\n            <div className=\"main\">\n              <div className=\"balance\" ref=\"balance\">\n                <span>\n                  <span className=\"dsign\">$</span>\n                  <span data-val>{balance.comma.split('.')[0]}</span>\n                </span>\n                <small>.<span data-val>{balance.comma.split('.')[1]}</span></small>\n              </div>\n              <div className=\"stats\">\n\n                <div className=\"stat\">\n                  {\n                    perc ? <div className=\"val\" ref=\"ytd\"><span data-val>{ytdPerc}</span><span className=\"psign\">%</span></div>\n                    : <div className=\"val\" ref=\"ytd\"><span className=\"dsign\">$</span><span data-val>{ytd.comma}</span></div>\n                  }\n                  <div className=\"title\">YTD Contributions</div>\n                  <div className=\"range\">\n                    <div style={{\n                      width: ytdRange + '%',\n                      background: colorMap.rotation,\n                      boxShadow: glow(getColorProperties(colorMap.rotation))\n                    }} />\n                  </div>\n                  <div className=\"details\">\n                    {\n                      perc ? <span><span className=\"dsign\">$</span>{ytd.comma} of max</span>\n                      : <span>{ytdPerc}<span className=\"psign\">%</span>of max</span>\n                    }\n                    <span><span className=\"dsign\">$</span>{max.comma}</span>\n                  </div>\n                </div>\n\n                <div className=\"stat\">\n                  {\n                    perc ? <div className=\"val\" ref=\"pl\"> <span data-val>{plPerc}</span><span className=\"psign\">%</span> </div>\n                    : <div className=\"val\" ref=\"pl\">\n                      <span>\n                        <span className=\"dsign\">$</span>\n                        <span data-val>{pl.comma.split('.')[0]}</span>\n                      </span>\n                      <small>.<span data-val>{pl.comma.split('.')[1]}</span></small>\n                    </div>\n                  }\n                  \n                  <div className=\"title\">{mobile ? 'P/L' : 'Earnings'} vs Principle</div>\n                  <div className=\"range\">\n                    <div style={{\n                      width: plRange + '%',\n                      background: pl.value < 0 ? colorMap.other : colorMap.conservative, // pink / blue\n                      boxShadow: glow(getColorProperties(pl.value < 0 ? colorMap.other : colorMap.conservative))\n                    }} />\n                  </div>\n                  <div className=\"details\">\n                    <span>\n                      { perc ? <span className=\"dsign\">$</span> : null }\n                      { perc ? pl.comma.replace(mobile ? '' : '-','') : Math.abs(plPerc) }\n                      { perc ? null : <span className=\"psign\">%</span> }\n                      { perc ? ' ' : null }{ mobile && perc ? null : plPerc >= 0 ? 'profit' : 'loss' }\n                    </span>\n                    <span><span className=\"dsign\">$</span>{total.comma}</span>\n                  </div>\n                </div>\n\n              </div>\n            </div>\n            <div className=\"data\">\n\n              <table>\n                <tbody>\n                  <tr className=\"label-row\">\n                    <td>Balance</td>\n                    <td>YTD {mobile ? 'Contrib.' : 'Contributions'}</td>\n                    <td>Total Fees</td>\n                  </tr>\n                  <tr className=\"data-row\">\n                    <td>${balance.comma}</td>\n                    <td>${ytd.comma}</td>\n                    <td>${formatMoney(round(latest.total_fees, 2), 2)}</td>\n                  </tr>\n\n                  <tr className=\"label-row\">\n                    <td>P/L</td>\n                    <td>Total {mobile ? 'Contrib.' : 'Contributions'}</td>\n                    <td>VTS Fees</td>\n                  </tr>\n                  <tr className=\"data-row\">\n                    <td>${pl.comma}</td>\n                    <td>${getNumberProperties(total.value - vts.value).comma}</td>\n                    <td>${vts.comma}</td>\n                  </tr>\n\n                  <tr className=\"label-row\">\n                    <td>P/L %</td>\n                    <td>Max {mobile ? 'Contrib.' : 'Contributions'}</td>\n                    <td>Account Age</td>\n                  </tr>\n                  <tr className=\"data-row\">\n                    <td>{plPerc}%</td>\n                    <td>${max.comma}</td>\n                    <td>{calcAge()}</td>\n                  </tr>\n                </tbody>\n              </table>\n\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\nimport moment from 'moment';\nimport { p5map, getLatest, shouldUpdate } from '../utils';\n\nrequire('./Volatility.css');\n\nexport default class Volatility extends Component {\n  state = {\n    bars: []\n  };\n  meta = {}\n\n  componentDidMount = () => {\n    this.calcData();\n    if(this.refs.bars) {\n      this.refs.bars.addEventListener('touchmove', e => e.stopPropagation(), { passive: false });\n    }\n  }\n\n  shouldComponentUpdate = shouldUpdate.bind(this, this)\n\n  componentDidUpdate = prevProps => {\n    // check if data changed\n    let dataChanged = false;\n    if(prevProps.data !== this.props.data) dataChanged = true;\n    if(prevProps.dataView !== this.props.dataView) dataChanged = true;\n    if(prevProps.feeAdjustments !== this.props.feeAdjustments) dataChanged = true;\n    if(prevProps.contributionAdjustments !== this.props.contributionAdjustments) dataChanged = true;\n    if(dataChanged) this.calcData();\n  }\n\n  calcData = () => {\n    const { history, activeDates } = this.props;\n    const stop = moment(this.props.data.meta.start_date);\n    const bars = [];\n\n    // start with last trading day and work backwards, max 30 bars\n    let date = getLatest(this.props.history, activeDates[1].clone()).date;\n    let prev = date.isSame(stop) ? date : getLatest(this.props.history, date.clone().subtract(1, 'days')).date;\n    while(bars.length < 30) {\n      // account for when the date is too close to the start_date\n      if(date.isSame(prev)) {\n        bars.push({ range: 0 });\n      } else {\n        const datestr = date.format('L'), prevstr = prev.format('L');\n\n        let prevClose = history[prevstr].adj.balance;\n        // if this day includes a transfer, adjust previous close rates by that too\n        if((history[datestr].transactions || []).find(t => t.type === 'transfer')) {\n          prevClose += history[datestr].transactions.filter(t => t.type === 'transfer').reduce((t,v) => t + v.amount, 0);\n        }\n        let high = history[datestr].adj.cash_balance,\n            low =  history[datestr].adj.cash_balance;\n\n        // calc estimated high and low based on remaining open positions\n        const { positions } = history[datestr];\n        Object.keys(history[datestr].positions || {}).forEach(sym => {\n          high += positions[sym].h * positions[sym].shares;\n          low += positions[sym].l * positions[sym].shares;\n        });\n\n        // high and low compared to previous close\n        high = Math.max(high, prevClose);\n        low = Math.min(low, prevClose);\n\n        bars.push({ range: high - low, date })\n        date = prev.clone();\n        if(prev.isAfter(stop)) {\n          prev = getLatest(this.props.history, prev.subtract(1, 'days')).date;\n        }\n      }\n\n    }\n\n    this.setState({ bars });\n  }\n\n  render = () => {\n    const { bars } = this.state;\n\n    const max = bars.reduce((max, curr) => Math.max(max, curr.range), 0);\n\n    return (\n      <div className=\"tile-container\" id=\"volatility\">\n        <div className=\"tile\">\n          <div className=\"header\">\n            <div className=\"title\">Volatility</div>\n          </div>\n          <div className=\"body\">\n            <div className=\"bars hide-scroll\" ref=\"bars\">\n              {\n                bars.map((bar,i) => {\n                  const height = p5map(bar.range, 0, max, 0, 100) || 0;\n                  return <div className=\"bar\" key={i} style={{ height: `${height}%` }} />\n                })\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\nimport moment from 'moment';\nimport { \n  round, \n  formatNumber,\n  getNumberProperties, \n  getColorProperties, \n  glow,\n  colorMap,\n  constrain,\n  getLatest,\n  formatMoney,\n  shouldUpdate,\n} from '../utils';\nimport { \n  threedot,\n} from '../utils/icons';\n\nrequire('./Breakdown.css');\n\nconst VTS = {\n  // 10% to free trades\n  tactical: {\n    tickers: [\n      'mdy', \n      'mvv', // 2x MDY\n      'ief', \n      'ust', // 2x IEF\n      'gld'\n    ],\n    label: 'VTS Tactical',\n    allocation: .225 // 25% of 90% of total\n  },\n  aggressive: {\n    tickers: [\n      'svxy',\n      'vixy'\n    ],\n    label: 'VTS Aggressive',\n    allocation: .225 // 25% of 90% of total\n  },\n  conservative: {\n    tickers: [\n      'ziv', // deprecated\n      'spy', \n      'sso', // 2x SPY\n      'spxl', // SVXY replacement\n      'tlt', \n      'vxx',\n    ],\n    label: 'VTS Conservative',\n    allocation: .225 // 25% of 90% of total\n  },\n  rotation: {\n    tickers: [\n      'vpu', \n      'vig', // deprecated\n      'vglt',\n      'qld', // 2x QQQ\n    ],\n    label: 'VTS Defensive Rotation',\n    allocation: .225 // 25% of 90% of total\n  }\n}\n\nexport default class Breakdown extends Component {\n  state = {\n    key: null,\n    showData: false,\n    tradeDetails: {},\n  }\n  meta = {}\n\n  componentWillMount = () => {\n    window.addEventListener('resize', this.resizeGraphs);\n    this.calcTradeDetails();\n  }\n\n  shouldComponentUpdate = shouldUpdate.bind(this, this)\n\n  componentDidMount = () => {\n    this.resizeGraphs();\n  }\n\n  componentDidUpdate = prevProps => {\n    if(prevProps !== this.props) this.calcTradeDetails();\n    else this.resizeGraphs();\n  }\n\n  componentWillUnmount = () => {\n    window.removeEventListener('resize', this.resizeGraphs);\n  }\n\n  getVTS = sym => {\n    return Object.keys(VTS).find(key => VTS[key].tickers.includes(sym));\n  }\n\n  calcTradeDetails = () => {\n    const { history, feeAdjustments } = this.props;\n    const tradeDetails = {};\n    history.meta.symbols_traded.forEach(sym => {\n      const key = this.getVTS(sym) || sym;\n      let dets = {\n        buys: 0, // total money spent\n        sells: 0, // total money back\n        trades: 0, // total completed trades\n        ...tradeDetails[key]\n      }\n      if(this.getVTS(sym)) dets.strat = VTS[this.getVTS(sym)].label\n      const day = moment(history.meta.start_date, 'L');\n      while(day.isSameOrBefore(this.props.activeDates[1], 'days')) {\n        const data = history[day.format('L')];\n        if(!data) {\n          day.add(1, 'days');\n          continue;\n        }\n\n        let adj = 0;\n        if(feeAdjustments) {\n          const coms = history.meta.commission.filter(c => moment(c[0], 'L').isSameOrBefore(day));\n          adj = coms[coms.length-1][1];\n        }\n\n        if(data.transactions) {\n          const transactions = data.transactions.filter(t => t.symbol === sym);\n          for(let i = 0; i < transactions.length; i++) {\n            const trans = transactions[i];\n            if(trans.type === 'buy') {\n              if((data.positions[sym] || {}).shares === trans.shares) dets.trades++;\n              dets.buys += Math.abs(trans.shares * trans.price) + adj;\n            }\n            if(trans.type === 'sell') dets.sells += Math.abs(trans.shares * trans.price) + adj;\n          }\n        }\n        \n        if(day.isSame(this.props.activeDates[1], 'days')) {\n          if(Object.keys(data.positions).includes(sym)) {\n            const currData = data.positions[sym];\n            dets.sells += currData.shares * currData.c;\n            dets = { ...dets, ...currData };\n          }\n          // calc totals\n          dets.total_pl = round(dets.sells - dets.buys, 2);\n          const perc = 100*(dets.sells - dets.buys)/dets.buys;\n          dets.total_pl_perc = round(perc, perc > 100 ? 0 : 1);\n        }\n        tradeDetails[key] = dets;\n        day.add(1, 'days');\n      }\n    });\n    this.setState({ tradeDetails });\n  }\n\n  resizeGraphs = () => {\n    const { graphs, body, svg, graphspace, keys, details } = this.refs;\n    const { display } = this.state;\n    if(!body || !graphs) return;\n\n    // resize graph container\n    const size = this.props.mobile ? Math.min(body.clientWidth, body.clientHeight) : Math.min(graphspace.clientWidth, graphspace.clientHeight);\n    graphs.style.width = size + 'px';\n    graphs.style.height = size + 'px';\n    graphs.setAttribute('data-sized', true);\n    graphs.querySelectorAll('svg').forEach(el => el.setAttribute('viewBox', `0 0 ${size} ${size}`))\n\n    // set svg viewboxes and items\n    svg.setAttribute('viewBox', `0 0 ${size} ${size}`);\n    const baseRadius = size / 2 - 10; // for stroke and glow spacing\n    [...svg.querySelectorAll('.color')].forEach(el => {\n      const i = el.getAttribute('data-index');\n      const r = constrain(baseRadius * (1 - (.15*i)), baseRadius - (18*i), baseRadius - (15*i));\n      el.setAttribute('r', Math.max(r,0));\n      el.style.strokeDasharray = 2 * Math.PI * r;\n      el.style.strokeDashoffset = parseFloat(el.style.strokeDasharray) * (1 - el.getAttribute('data-perc'));\n    });\n    [...svg.querySelectorAll('.track')].forEach((el, i) => {\n      const r = constrain(baseRadius * (1 - (.15*i)), baseRadius - (18*i), baseRadius - (15*i));\n      el.setAttribute('r', Math.max(r,0));\n    });\n    [...document.querySelectorAll('.mark')].forEach(crc => {\n      const el = crc.parentNode;\n      el.setAttribute('viewBox', `0 0 ${size} ${size}`);\n      const circle = el.querySelector('.mark');\n      const i = circle.getAttribute('data-index');\n      const r = constrain(baseRadius * (1 - (.15*i)), baseRadius - (18*i), baseRadius - (15*i));\n      circle.setAttribute('r', Math.max(r,0));\n      circle.style.strokeDasharray = 2 * Math.PI * r;\n      circle.style.strokeDashoffset = parseFloat(circle.style.strokeDasharray) - .01;\n      el.style.transform = `rotate(${-90 + (360 * circle.getAttribute('data-perc'))}deg)`;\n    });\n  }\n\n  render = () => {\n    const { data, activeDates, mobile } = this.props;\n    const { key, showData } = this.state;\n    const latest = getLatest(data, activeDates[1]).data;\n\n    const positions = {\n      tactical: {\n        index: 0,\n        syms: []\n      },\n      conservative: {\n        index: 1,\n        syms: []\n      },\n      aggressive: {\n        index: 2,\n        syms: []\n      },\n      rotation: {\n        index: 3,\n        syms: []\n      },\n      other: {\n        syms: [],\n        shares: [],\n        avgs: [],\n        dates: [],\n        index: 4,\n      },\n      cash: {\n        value: latest.cash_balance,\n        index: 100,\n      }\n    }\n    Object.keys(latest.positions).forEach(sym => {\n      const { shares, avg, since } = latest.positions[sym],\n            cost = shares * avg,\n            useOther = !this.getVTS(sym),\n            pos = positions[this.getVTS(sym) || 'other'];\n      if(useOther) {\n        pos.shares.push(shares); // remove\n        pos.avgs.push(avg); // remove\n        pos.value = (pos.value || 0) + cost; // remove\n        pos.dates.push(since); // remove \n        pos.syms.push(sym);\n      } else {\n        pos.shares = shares; // remove\n        pos.value = cost; // remove\n        pos.date = since; // remove\n        pos.syms.push(sym);\n      }\n    })\n    const total = Object.keys(positions).map(key => positions[key].value || 0).reduce((t,v) => t+v);\n    Object.keys(positions).forEach(key => { positions[key].perc = (positions[key].value || 0) / total });\n\n    const renderDetails = () => {\n      if(!key) return null;\n      if(key === 'cash') {\n        return <div className=\"group\">\n          <div className=\"row\">\n            <div style={{width: '100%', textAlign: 'center'}}>\n              <div className=\"label\">Cash Balance</div>\n              <div className=\"value\">${formatMoney(latest.adj.cash_balance)}</div>\n            </div>\n          </div>\n        </div>\n      }\n      const syms = key !== 'other' ? [key] : Object.keys(latest.positions).filter(s => !this.getVTS(s));\n      const html = syms.map(sym => {\n        const dets = this.state.tradeDetails[this.getVTS(sym) || sym];\n        return <div className=\"group\" key={sym}>\n          <div className=\"single strat\">{ dets.strat || sym.toUpperCase() }</div>\n          <div className=\"row\">\n            <div className=\"col\">\n              <div className=\"label\">Total P/L</div>\n              <div className=\"value\">${formatMoney(dets.total_pl)}</div>\n            </div>\n            <div className=\"col\">\n              <div className=\"label\">Total P/L %</div>\n              <div className=\"value\">{getNumberProperties(dets.total_pl_perc).comma}%</div>\n            </div>\n            <div className=\"col\">\n              <div className=\"label\">Total Traded</div>\n              <div className=\"value\">${formatMoney(round(dets.buys, 2))}</div>\n            </div>\n          </div>\n          {\n            !dets.shares ? null :\n            [\n              <div className=\"single date\" key=\"since\">{dets.since}</div>,\n              <div className=\"row\" key=\"r1\">\n                <div className=\"col\">\n                  <div className=\"label\">Shares</div>\n                  <div className=\"value\">{formatNumber(dets.shares,1)}</div>\n                </div>\n                <div className=\"col\">\n                  <div className=\"label\">Avg</div>\n                  <div className=\"value\">${formatMoney(round(dets.avg, 2))}</div>\n                </div>\n                <div className=\"col\">\n                  <div className=\"label\">Trade #</div>\n                  <div className=\"value\">{dets.trades}</div>\n                </div>\n              </div>,\n              <div className=\"row\" key=\"r2\">\n                <div className=\"col\">\n                  <div className=\"label\">P/L Open</div>\n                  <div className=\"value\">${formatMoney(round(dets.shares * dets.c - dets.shares * dets.avg, 2))}</div>\n                </div>\n                <div className=\"col\">\n                  <div className=\"label\">P/L Open %</div>\n                  <div className=\"value\">{getNumberProperties(round(100*(dets.shares * dets.c - dets.shares * dets.avg)/(dets.shares*dets.avg), 1)).comma}%</div>\n                </div>\n                <div className=\"col\">\n                  <div className=\"label\">Trade Cost</div>\n                  <div className=\"value\">${formatMoney(round(dets.shares * dets.avg, 2))}</div>\n                </div>\n              </div>\n            ]\n          }\n        </div>\n      })\n      return html;\n    }\n\n    const renderKeys = () => {\n      if(mobile) return null;\n\n      return <div className=\"stats-container main\" >\n        <div className=\"keys\" ref=\"keys\">\n          {\n            Object.keys(positions).sort((a,b) => positions[a].index - positions[b].index).map(pos => {\n              const active = positions[pos].perc > 0;\n              let val;\n              if(pos === 'cash') val = `$${formatMoney(positions[pos].value)}`;\n              else if(active) val = positions[pos].syms.join(', ');\n\n              const renderKey = (text, sub) => {\n                return <div \n                  data-type={pos}\n                  className={`key ${active ? 'active' : ''}`} \n                  key={text}\n                  onClick={e => this.setState({ key: pos === key ? null : pos, showData: true, slide: 0 })}\n                >\n                  <div className=\"icon\" style={pos === 'cash' ? { visibility: 'hidden' } : null}>\n                    <div style={{\n                      background: colorMap[pos], \n                      boxShadow: glow(getColorProperties(colorMap[pos]))\n                    }} />\n                  </div>\n                  <div className=\"title\">\n                    {pos}\n                    <span>{sub}</span>\n                  </div>\n                </div>\n              }\n              return renderKey(pos, val);\n            })\n          }\n        </div>\n      </div>\n    }\n\n    const renderSlides = () => {\n      return <div className=\"data\">\n        <div className=\"slides\" style={{ transform: `translateX(${-100 * this.state.slide}%)`}}>\n          <div className=\"slide\">\n            {\n              Object.keys(latest.positions).map(key => {\n                const pos = latest.positions[key];\n                const pl = getNumberProperties(round((pos.c - pos.avg) * pos.shares, 2)).comma,\n                      plPercVal = (pos.c - pos.avg) / pos.avg * 100,\n                      plPerc = round(plPercVal,\n                               Math.abs(plPercVal) < 1 ? 2 :\n                               Math.abs(plPercVal) < 10 ? 1 : 0),\n                      isNeg = plPercVal < 0;\n                return <div className=\"position\" key={key}>\n                  <div className=\"sym\">{key}</div>\n                  <div>\n                    <div className=\"pl\" style={{ color: colorMap[isNeg ? 'other' : 'tactical']}}>${formatMoney(pl, 2)}</div>\n                    <div className=\"perc\" style={{ background: colorMap[isNeg ? 'other' : 'tactical']}}>{plPerc}%</div>\n                  </div>\n                </div>\n              })\n            }\n          </div>\n          <div className=\"slide\">\n            this slide will include details on each VTS strategy: historical performance, current positions and % allocation (planned vs actual).\n          </div>\n        </div>\n      </div>\n    }\n\n    return (\n      <div className=\"tile-container\" id=\"breakdown\">\n        <div className={`tile ${showData ? 'show-data' : ''}`}>\n          {\n            mobile ? null :\n            <div className=\"data-toggle\" onClick={e => this.setState({showData: !showData})}>{showData ? <span>+</span> : threedot}</div>\n          }\n          <div className=\"header\">\n            <div className=\"title\">Positions</div>\n          </div>\n          <div className=\"body\" ref=\"body\">\n            <div className=\"space main\" ref=\"graphspace\" onClick={mobile ? e => this.setState({ showData: !showData, slide: 0 }) : null}>\n              <div className=\"radial-graphs square\" ref=\"graphs\">\n                <svg ref=\"svg\">\n                  <defs>\n                    <filter id=\"glow\">\n                      <feGaussianBlur stdDeviation=\"2\" result=\"coloredBlur\"/>\n                        <feMerge>\n                          <feMergeNode in=\"coloredBlur\"/>\n                          <feMergeNode in=\"SourceGraphic\"/>\n                        </feMerge>\n                      </filter>\n                  </defs>\n                  { \n                    Object.keys(positions).filter(pos => pos !== 'cash').map(pos => (\n                      <circle key={pos} className=\"track\" cx=\"50%\" cy=\"50%\" />\n                    )) \n                  }\n                  {\n                    Object.keys(positions).filter(pos => pos !== 'cash').map(pos => (\n                      <circle \n                        key={pos}\n                        className=\"color\"\n                        data-index={positions[pos].index}\n                        data-perc={Math.max(positions[pos].perc, .00001)}\n                        style={{ stroke: colorMap[pos] }}\n                        filter=\"url(#glow)\"\n                        cx=\"50%\" \n                        cy=\"50%\" \n                      />\n                    ))\n                  }\n                </svg>\n                {\n                  Object.keys(positions).filter(pos => pos !== 'cash').map(pos => {\n                    if(pos === 'cash') return null;\n                    let goal; // percent size of account\n                    if(VTS[pos]) goal = VTS[pos].allocation;\n                    else goal = 1 - Object.keys(VTS).reduce((t,v) => t + VTS[v].allocation, 0);\n\n                    // TODO make more accurate based on prices\n                    return <svg id={'mark-'+pos} key={pos}>\n                      <circle \n                        className=\"mark\"\n                        data-index={positions[pos].index}\n                        data-perc={goal}\n                        style={{ stroke: goal > positions[pos].perc ? colorMap[pos] : null }}\n                        cx=\"50%\" \n                        cy=\"50%\" \n                      />\n                    </svg>\n                  })\n                }\n              </div>\n            </div>\n            \n            { renderKeys() }\n\n            { renderSlides() }\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\n\n// require('./Interface.css');\n\nexport default class Charts extends Component {\n  state = {};\n  meta = {}\n\n  componentDidMount = () => {}\n\n  toggle = () => {}\n\n  render = () => {\n    return (\n      <div className=\"tile-container\" id=\"charts\">\n        <div className=\"tile\">CHARTS</div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\nimport anime from 'animejs';\nimport moment from 'moment';\nimport { \n  cap,\n  glow,\n  round,\n  p5map,\n  colorMap,\n  getLatest,\n  constrain,\n  formatMoney,\n  shouldUpdate,\n  generateAggs,\n  getClosestParent,\n  getColorProperties,\n  getNumberProperties,\n} from '../utils';\nimport {\n  angle,\n  thinsearch,\n  arrow\n} from '../utils/icons';\n\nconst DELAY = 350;\n\nrequire('./History.css');\n\nconst PERC = val => val ? round(val, Math.abs(val) < 1 ? 2 : Math.abs(val) < 10 ? 1 : 0) : 0\nconst INITIAL_STATE = {\n  search: '',\n  filter: [],\n  selectedSymbol: null,\n  toggledYears: [],\n  showAllTransactions: false,\n  showSymbolList: false,\n}\n\nexport default class History extends Component {\n  state = INITIAL_STATE\n  meta = {\n    key: 0,\n    transactions: [],\n  }\n\n  shouldComponentUpdate = shouldUpdate.bind(this, this)\n\n  componentDidMount = () => {\n    const { history } = this.props;\n    const end = moment(history.meta.last_updated, 'L'),\n          day = moment(history.meta.start_date, 'L');\n    let latestVTS = history.meta.vts_rates[0], vtsIndexOf = 0, isActiveVTS;\n    while(day.isSameOrBefore(end, 'days')) {\n      const d = history[day.format('L')]\n      // check if VTS rate needs to be updated\n      if(history.meta.vts_rates.length - 1 > vtsIndexOf && day.isSameOrAfter(history.meta.vts_rates[vtsIndexOf + 1][0])) {\n        latestVTS = history.meta.vts_rates[vtsIndexOf + 1];\n        vtsIndexOf = vtsIndexOf + 1;\n      }\n      if(d && d.transactions) this.meta.transactions.push(...d.transactions);\n      const prev = day.clone();\n      day.add(1, 'days');\n      // VTS fees are charged every 30th or last day of the month, whichever is last\n      if((prev.date() === 30 || (prev.date() < 30 && day.date() === 1)) && (isActiveVTS || prev.isSameOrAfter(latestVTS[0]))) {\n        isActiveVTS = true;\n        this.meta.transactions.push({\n          amount: latestVTS[1],\n          date: prev.format('L'),\n          text: 'Volatility Trading Strategies (VTS) Subscription',\n          type: 'fee'\n        })\n      }\n    }\n  }\n\n  componentDidUpdate = (prevProps, prevState) => {\n    const { mobile } = this.props;\n\n    // if popup was toggled to show or hide\n    if(prevProps.show !== this.props.show) {\n      if(this.props.show) { // OPEN\n        if(this.refs.transactions) this.refs.transactions.scrollTop = 0;\n        if(this.refs.filters) this.refs.filters.scrollLeft = 0;\n        this.fadeInRows(300);\n        if(!mobile) {\n          setTimeout(e => {\n            if(this.refs.input) this.refs.input.focus();\n          }, 50);\n          window.addEventListener('keydown', this.handleKey);\n        }\n        setTimeout(e => {\n          this.setAggs();\n          this.fadeInSymbols();\n        }, DELAY);\n      } else { // CLOSE\n        if(this.refs.input) {\n          this.refs.input.blur();\n          this.refs.input.value = '';\n        }\n        setTimeout(e => {\n          if(!this.props.show) this.setState(INITIAL_STATE);\n          this.meta.key++;\n        }, 350);\n        window.removeEventListener('keydown', this.handleKey);\n      }\n    }\n\n    // if search bar is used, auto-scroll the symbol selector to the highlighted symbol\n    if(\n      (prevState.search !== this.state.search && !this.state.selectedSymbol && this.state.search) ||\n      (!this.state.search && this.state.selectedSymbol && prevState.selectedSymbol !== this.state.selectedSymbol)\n    ) {\n      const sym = this.state.selectedSymbol || this.props.history.meta.symbols_traded.find(s => s.startsWith(this.state.search));\n      if(sym) {\n        [...document.querySelectorAll('.history .details .stock-opts .active')].forEach(el => el.classList.remove('active'));\n        const el = document.querySelector(`.history .details .stock-opts li[data-sym=\"${sym}\"]`);\n        // scroll to el\n        if(el) {\n          el.classList.add('active');\n          const elLeft = el.getBoundingClientRect().left,\n                parentLeft = el.parentNode.getBoundingClientRect().left;\n          if(this.meta.scrollTo) this.meta.scrollTo.pause();\n          this.meta.scrollTo = anime({\n            targets: el.parentNode, \n            scrollLeft: Math.max(el.parentNode.scrollLeft + elLeft - parentLeft - 40, 0),\n            easing: 'easeOutExpo',\n            duration: 350,\n          })\n        }\n      }\n    }\n\n    // if re-showing transactions (in mobile)\n    if(prevState.showSymbolList && !this.state.showSymbolList) this.fadeInRows();\n    // if showing stock opts (in mobile)\n    if(!prevState.showSymbolList && this.state.showSymbolList) this.fadeInSymbols();\n    // if showing stock opts (in regular)\n    if(!mobile && this.getSym(prevProps, prevState) && !this.getSym()) this.fadeInSymbols();\n    // if showing details page, delay rendering of transactions (in mobile)\n    if(mobile && !prevState.selectedSymbol && this.state.selectedSymbol) {\n      setTimeout(() => {\n        ((this.refs.detailtransactions || {}).style || {}).display = '';\n      }, 350)\n    }\n  }\n\n  handleKey = e => {\n    if(e.key === 'Escape') return;\n    e.stopPropagation();\n    if(this.refs.input) this.refs.input.focus();\n  }\n\n  setAggs = () => {\n    if(this.meta.aggs) return;\n    this.meta.aggs = generateAggs(this.props);\n  }\n\n  fadeInRows = delay => {\n    if(!this.refs.transactions) return;\n    this.refs.transactions.scrollTop = 0;\n    // sequentially fade in first 15 rows\n    const rows = [...this.refs.transactions.querySelectorAll('.row')];\n    // animate in\n    if(this.meta.rowsAnime) this.meta.rowsAnime.pause();\n    this.meta.rowsAnime = anime.timeline().add({\n      targets: rows,\n      opacity: [0,1],\n      easing: 'easeOutSine',\n      duration: 500,\n      delay: (el, i, l) => (delay || 0) + (i * 75),\n      complete: anim => this.setState({ showAllTransactions: true })\n    })\n  }\n\n  fadeInSymbols = () => {\n    if(!this.refs.opts) return;\n    const opts = [...this.refs.opts.querySelectorAll('li')];\n    // animate in\n    if(this.meta.optsAnime) this.meta.optsAnime.pause();\n    this.meta.optsAnime = anime.timeline().add({\n      targets: opts,\n      scale: [0,1],\n      easing: 'easeOutSine',\n      duration: 250,\n      delay: (el, i, l) => 100 + (i * 20),\n    })\n  }\n\n  setSym = (sym, skipSearch) => {\n    if(this.refs.input && !skipSearch) this.refs.input.value = '';\n    this.setState({ selectedSymbol: sym, search: skipSearch ? this.state.search : '', toggledYears: [] });\n  }\n\n  getSym = (props=this.props, state=this.state) => {\n    const { search, selectedSymbol } = state;\n    return selectedSymbol || (search && props.history.meta.symbols_traded.find(s => s.startsWith(search)));\n  }\n\n  getXY = e => ({\n    x: round(e.pageX || e.touches[0].clientX),\n    y: round(e.pageY || e.touches[0].clientY)\n  })\n\n  moveWindowStart = e => {\n    if(!e || (!e.pageY && !e.touches)) return;\n    // prevent drag propagation on a few items\n    if(this.getSym() && getClosestParent(e.target, '.stock-opts')) return;\n\n    e.persist();\n    const { x, y } = this.getXY(e);\n    this.meta.drag = {\n      startX: x,\n      startY: y,\n      lastX: x,\n      lastY: y,\n      target: e.target,\n      time: performance.now(),\n      interface: document.querySelector('.app .interface')\n    }\n  }\n\n  moveWindow = e => {\n    const { drag } = this.meta;\n    if(!drag || !e || (!e.pageY && !e.touches)) return;\n    e.persist();\n    const { x, y } = this.getXY(e);\n    if(x === drag.lastX && y === drag.lastY) return;\n\n    // if initial move direction, determine what action to perform\n    if(!drag.action) {\n      // if details pane is open\n      if(this.getSym() && this.refs.details) {\n        // if swiping to the right, hide details\n        if(x > drag.startX && Math.abs(y - drag.startY) < 3) {\n          drag.action = 'exit_sym';\n          this.refs.details.style.transitionDuration = '0s';\n        } \n        // if swiping down when at the top of scroll, hide window\n        else if(y > drag.startY && Math.abs(x - drag.startX) < 3 && !this.refs.symdetails.scrollTop) {\n          drag.action = 'exit';\n          this.refs.window.style.transitionDuration = '0s';\n          drag.interface.style.transitionDuration = '0s';\n        }\n        else {\n          delete this.meta.drag;\n          return;\n        };\n      }\n      // if on main transactions page (swiping from top bar, or swiping down anywhere when no scroll)\n      else if(getClosestParent(drag.target, '.search') || (y > drag.startY && Math.abs(x - drag.startX) < 3 && !(this.refs.transactions || {}).scrollTop)) {\n        drag.action = 'exit';\n        this.refs.window.style.transitionDuration = '0s';\n        drag.interface.style.transitionDuration = '0s';\n      }\n      // unknown other cases\n      else {\n        delete this.meta.drag\n        return;\n      }\n    }\n\n    if(drag.action === 'exit_sym') {\n      // calculate how much to move window\n      drag.percDragged = constrain(p5map(x, drag.startX, window.screen.width + drag.startX, 0, 100), 0, 100);\n      this.refs.details.style.left = drag.percDragged + '%';\n    }\n\n    if(drag.action === 'exit') {\n      // calculate how much to move window\n      drag.dragged = constrain(p5map(y, drag.startY, window.screen.height + drag.startY, 40, window.screen.height), 40, window.screen.height);\n      const perc = constrain(p5map(y, drag.startY, window.screen.height + drag.startY, 0, 100), 0, 100);\n      this.refs.window.style.top = drag.dragged + 'px';\n      // calculate the transition of the background\n      const cutoff = 30;\n      drag.interface.style.transitionDuration = '0s';\n      drag.interface.style.transform = `scale(${constrain(p5map(perc, 0, cutoff, .95, 1), .95, 1)}) translateY(${constrain(p5map(perc, 0, cutoff, -5, 0), -5, 0)}px)`;\n      drag.interface.style.background = `rgba(0,0,30,${constrain(p5map(perc, 0, cutoff, .35, 0), 0, .35)})`;\n      drag.interface.style.borderRadius = `${constrain(p5map(perc, 0, cutoff, 15, 0), 0, 15)}px`;\n    }\n\n    drag.dirX = drag.lastX > x ? 'left' : 'right';\n    drag.dirY = drag.lastY > y ? 'up' : 'down';\n    drag.lastX = x;\n    drag.lastY = y;\n    drag.time = performance.now();\n    e.stopPropagation();\n  }\n\n  moveWindowEnd = e => {\n    const { drag } = this.meta;\n    if(!drag || !e || (!e.pageY && !e.touches)) return;\n    // nothing happened\n    if(drag.lastX === drag.startX && drag.lastY === drag.startY) return;\n\n    const fast = performance.now() - this.meta.drag.time < 75;\n\n    if(drag.action === 'exit_sym') {\n      this.refs.details.style.left = '';\n      this.refs.details.style.transitionDuration = '';\n      if(drag.dirX === 'right' && (drag.percDragged > 40 || fast)) {\n        if(fast) this.refs.details.style.transitionDuration = '.1s';\n        this.refs.details.classList.remove('show');\n        // clear the temporary high speed transition\n        setTimeout(e => {\n          if(this.refs.details) this.refs.details.style.transitionDuration = '';\n          this.setSym();\n        }, fast ? 100 : 350)\n      }\n    }\n\n    if(drag.action === 'exit') {\n      this.refs.window.style.top = '';\n      this.refs.window.style.transitionDuration = '';\n      drag.interface.style.transitionDuration = '';\n      drag.interface.style.transform = '';\n      drag.interface.style.background = '';\n      drag.interface.style.borderRadius = '';\n      if(drag.dirY === 'down' && (drag.dragged > (window.screen.height * .3) || fast)) {\n        if(fast) {\n          this.refs.window.style.transitionDuration = '.15s';\n          drag.interface.style.transitionDuration = '.15s';\n        }\n        this.props.close();\n        // clear the temporary high speed transition\n        setTimeout(e => {\n          if(drag.interface) drag.interface.style.transitionDuration = '';\n          if(this.refs.window) this.refs.window.style.transitionDuration = '';\n        }, fast ? 150 : 350)\n      }\n    }\n\n    delete this.meta.drag;\n  }\n\n  render = () => {\n    const { filter, search } = this.state;\n    const typeMap = {\n      buy: colorMap.tactical,\n      sell: colorMap.other,\n      fee: colorMap.rotation,\n      adj: colorMap.aggressive,\n      transfer: colorMap.aggressive,\n      dividend: colorMap.conservative\n    }\n    const sym = this.getSym();\n    const latest = this.props.show ? getLatest(this.props.history) : {},\n          lData = (latest.data || {}).positions || {};\n\n    const renderFilters = () => {\n      return <div className=\"filters hide-scroll\" ref=\"filters\">\n        {\n          Object.keys(typeMap).map(type => {\n            return <div \n              key={type}\n              className={`${filter.includes(type) ? 'active' : ''} pill`}\n              style={{ \n                boxShadow: glow(getColorProperties(typeMap[type])),\n                borderColor: typeMap[type],\n                color: typeMap[type],\n              }} \n              onClick={e => {\n                if(filter.includes(type)) this.setState({ filter: filter.filter(f => f !== type) });\n                else this.setState({ filter: [...filter, type ] });\n              }}\n            >\n              { type === 'adj' ? 'adjustment' : type }\n            </div>\n          })\n        }\n      </div>\n    }\n\n    const renderStockOpts = () => {\n      const sym = this.state.selectedSymbol || (search && this.props.history.meta.symbols_traded.find(s => s.startsWith(search)));\n      return (\n        <ul key={`opts-${this.meta.key}`} className=\"stock-opts hide-scroll\" ref=\"opts\">\n          {\n            this.props.history.meta.symbols_traded.sort((a,b) => a < b ? -1 : 1).map(sym => {\n              const selected = sym === this.state.selectedSymbol;\n              return <li \n                key={sym} \n                data-sym={sym} \n                className={`${selected ? 'single active' : ''} ${lData[sym] ? 'active-trade' : ''}`} \n                title={lData[sym] ? 'Actively traded' : null}\n                onClick={e => this.setSym(!selected && sym)}\n              >\n                { sym.toUpperCase() }\n                { lData[sym] && <div className=\"active-dot\" /> }\n              </li>\n            })\n          }\n        </ul>\n      )\n    }\n\n    const renderSymbolList = () => {\n      return <div className=\"symbols-list\">\n        {\n          this.props.mobile ? <div className=\"symbols-list-wrapper\">{ renderStockOpts() }</div>\n          : renderStockOpts()\n        }\n      </div>\n    }\n\n    const renderTransactions = override => {\n      if(!override && this.state.showSymbolList) return renderSymbolList();\n\n      let rows = this.meta.transactions.filter(t => {\n        if(override) return ['buy','sell','dividend'].includes(t.type) && (t.symbol || '').includes(override);\n        if(filter.length && !filter.includes(t.type)) return false;\n        if(search) {\n          if(this.props.history.meta.symbols_traded.find(s => s.startsWith(search)) && (t.symbol || '').startsWith(search)) return true;\n          if(t.type.startsWith(search)) return true;\n          if((t.text || '').toLowerCase().includes(search)) return true;\n          return false;\n        }\n        return true;\n      }).reverse();\n      if(!override && (!this.state.showAllTransactions || !this.props.show)) rows = rows.slice(0, 17);\n\n      return <div className=\"transactions\" ref=\"transactions\">\n        { !override && renderFilters() }\n        {\n          rows.map((t,i) => {\n            let text = t.text.toLowerCase().replace('(vts)', '(VTS)');\n            const date = moment(t.date);\n            this.props.history.meta.symbols_traded.forEach(sym => {\n              text = text.replace(sym, sym.toUpperCase())\n            });\n            return <div key={i} className={`row ${t.symbol ? 'clickable' : ''}`} title={t.text} onClick={t.symbol ? e => {\n              if(t.symbol === this.state.selectedSymbol) return;\n              this.setSym(t.symbol, true);\n            } : null}>\n              <div \n                className=\"banner\" \n                style={{ \n                  background: typeMap[t.type], \n                  boxShadow: glow(getColorProperties(typeMap[t.type])) \n                }} \n              />\n              <div className=\"row-content hide-scroll\">\n                <div className=\"meta\">\n                  <small title={t.date}>{date.format('MMM D, YYYY')}</small>\n                  <p>{cap(t.type === 'adj' ? 'adjustment' : t.type)} {((['buy','sell'].includes(t.type) && t.symbol) || '').toUpperCase()}</p>\n                </div>\n                <div className=\"meta\">\n                  <small>Amount</small>\n                  <p>{formatMoney(t.type === 'adj' ? t.amount : Math.abs(t.amount), 2)}</p>\n                </div>\n                {\n                  ['buy','sell'].includes(t.type) && [\n                    <div className=\"meta\" key=\"shares\">\n                      <small>Shares</small>\n                      <p>{t.shares}</p>\n                    </div>,\n                    <div className=\"meta\" key=\"price\">\n                      <small>Price</small>\n                      <p>{formatMoney(t.price)}</p>\n                    </div>,\n                    <div className=\"meta\" key=\"commission\">\n                      <small>Commission</small>\n                      <p>{formatMoney(t.commission)}</p>\n                    </div>\n                  ]\n                }\n                {\n                  t.reg_fee > 0 && <div className=\"meta\">\n                    <small>Regulatory Fee</small>\n                    <p>{formatMoney(t.reg_fee)}</p>\n                  </div>\n                }\n                {\n                  ['adj','transfer','fee','dividend'].includes(t.type) && <div className=\"meta text\">\n                    <small>Description</small>\n                    <p>{text}</p>\n                  </div>\n                }\n                <div className=\"meta text\">\n                  <small>Time</small>\n                  <p style={{ textTransform: 'initial' }}>{date.format('h:mm:ss a')}</p>\n                </div>\n              </div>\n            </div>\n          })\n        }\n        {\n          override || this.state.showAllTransactions ? (\n            <div className=\"footer\">\n              <b>{ getNumberProperties(rows.length).comma }</b> transaction{rows.length === 1 ? '' : 's'}\n            </div>\n          ) : (\n            <div className=\"footer\">Loading...</div>\n          )\n        }\n      </div>\n    }\n\n    const renderDetails = () => {\n      if(!sym && this.props.mobile) return null;\n      if(!sym || !this.meta.aggs) return <div className=\"empty-details\"> { renderStockOpts() } </div>;\n\n      const aggs = this.meta.aggs[sym];\n      const activeDot = <div className=\"active-dot\" style={{ background: colorMap.conservative, boxShadow: glow(getColorProperties(colorMap.conservative)) }} title=\"Actively traded stock\" />\n      const clear = <div className=\"clear\" onClick={e => this.setSym()}>{ angle }</div>\n      let small = '' + round(Math.abs(aggs.total_pl % 1) * 100);\n      if(small.length === 1) small = '0' + small;\n      const balance = (\n        <div key=\"balance\" className=\"balance\">\n          <span>{getNumberProperties(Math.floor(aggs.total_pl)).comma}</span>.<small>{small}</small>\n          <div className={`percent percent-tag ${aggs.total_pl < 0 ? 'neg' : 'pos'}`}>\n            { arrow }\n            { PERC(aggs.total_pl_perc) }%\n          </div>\n        </div>\n      )\n\n      let title = <div className=\"sym\"> \n        { sym.toUpperCase() }{ lData[sym] && activeDot } \n        { clear }\n        { this.props.mobile && balance }\n      </div>;\n      if(search && search !== sym && sym.includes(search)) {\n        title = <div className=\"sym\">\n          { search.toUpperCase() }<span>{ sym.replace(search, '').toUpperCase() }</span>\n          { lData[sym] && activeDot }\n          { clear }\n        </div>\n      };\n\n      let currPL = lData[sym] && formatMoney((lData[sym].c - lData[sym].avg) * lData[sym].shares), \n          currPLPerc = lData[sym] && PERC((lData[sym].c - lData[sym].avg) / lData[sym].avg * 100);\n      return [\n        <div className=\"details-content hide-scroll\" key={sym} ref=\"symdetails\">\n          { title }\n          {\n            !this.props.mobile && [\n              <div key=\"div\" className=\"divider\" />,\n              balance\n            ]\n          }\n          {\n            lData[sym] && aggs.current && \n            <div className=\"metrics active\" style={{ borderColor: colorMap.conservative, boxShadow: glow(getColorProperties(colorMap.conservative)) }}>\n              <div className=\"metric double\">\n                <div className=\"header\">P/L</div>\n                <div className=\"value\">{currPL} <span className=\"mute\">|</span> {currPLPerc}%</div>\n              </div>\n              <div className=\"metric double\" title={`${aggs.current.days_in_trade} day${aggs.current.days_in_trade === 1 ? '' : 's'}`}>\n                <div className=\"header\">Since</div>\n                <div className=\"value\">{moment(aggs.current.since).format('MMM D, YYYY')}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Avg</div>\n                <div className=\"value\">{formatMoney(aggs.current.avg)}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Shares</div>\n                <div className=\"value\">{getNumberProperties(aggs.current.shares).comma}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Max Gain</div>\n                <div className=\"value\">{PERC(aggs.current.max_upside)}%</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Max Loss</div>\n                <div className=\"value\">{PERC(aggs.current.max_drawdown)}%</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Open</div>\n                <div className=\"value\">{formatMoney(aggs.current.o)}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">High</div>\n                <div className=\"value\">{formatMoney(aggs.current.h)}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Low</div>\n                <div className=\"value\">{formatMoney(aggs.current.l)}</div>\n              </div>\n              <div className=\"metric\">\n                <div className=\"header\">Close</div>\n                <div className=\"value\">{formatMoney(aggs.current.c)}</div>\n              </div>\n            </div>\n          }\n          <div className=\"divider\" />\n          <div className=\"metrics\">\n            <div className=\"metric\">\n              <div className=\"header\">Avg P/L</div>\n              <div className=\"value\">{PERC(aggs.avg_pl_perc)}%</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\">Max Upside</div>\n              <div className=\"value\">{PERC(aggs.max_upside)}%</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\">Max Drawdown</div>\n              <div className=\"value\">{PERC(aggs.max_drawdown)}%</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\">Dividends</div>\n              <div className=\"value\">{aggs.dividends ? formatMoney(aggs.dividends) : '-'}</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\">Fees</div>\n              <div className=\"value\">{aggs.fees ? formatMoney(aggs.fees) : '-'}</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\" title=\"Avg days holding this position\">Avg Days in Trade</div>\n              <div className=\"value\">{getNumberProperties(round(aggs.avg_days_in_trade)).comma}</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\" title=\"Total trades, every trade included\">Trades</div>\n              <div className=\"value\">{getNumberProperties(aggs.trades).comma}</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\" title=\"Total full trade cycles\">Cycles</div>\n              <div className=\"value\">{getNumberProperties(aggs.cycles).comma}</div>\n            </div>\n            <div className=\"metric\">\n              <div className=\"header\" title=\"Total days holding this position\">Total Days in Trade</div>\n              <div className=\"value\">{getNumberProperties(aggs.days_in_trade).comma}</div>\n            </div>\n          </div>\n          <div className=\"divider\" />\n          {\n            Object.keys(aggs.years).sort((a,b) => b - a).map((year,i,total) => {\n              const yaggs = aggs.years[year];\n              const toggled = this.state.toggledYears.includes(year);\n              return [\n                <div className=\"year\" key={year}>\n                  <div \n                    className={`toggle ${yaggs.total_pl ? '' : 'disabled'}`} \n                    onClick={e => {\n                      if(!yaggs.total_pl) return;\n                      if(toggled) this.setState({ toggledYears: this.state.toggledYears.filter(y => y !== year) });\n                      else this.setState({ toggledYears: [...this.state.toggledYears, year] });\n                    }}\n                  >\n                    <h1>{ year }</h1> \n                    {\n                      !yaggs.total_pl ? null :\n                      <div>\n                        <span>{formatMoney(yaggs.total_pl)}</span>\n                        <div className={`percent percent-tag ${yaggs.total_pl < 0 ? 'neg' : 'pos'}`}>\n                          { arrow }\n                          { PERC(yaggs.total_pl_perc) }%\n                        </div>\n                      </div>\n                    }\n                  </div>\n                  {\n                    toggled && <div className=\"extended\">\n                      <div className=\"metrics\">\n                        <div className=\"metric\">\n                          <div className=\"header\">Avg P/L</div>\n                          <div className=\"value\">{PERC(yaggs.avg_pl_perc)}%</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\">Max Upside</div>\n                          <div className=\"value\">{PERC(yaggs.max_upside)}%</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\">Max Drawdown</div>\n                          <div className=\"value\">{PERC(yaggs.max_drawdown)}%</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\">Dividends</div>\n                          <div className=\"value\">{yaggs.dividends ? formatMoney(yaggs.dividends) : '-'}</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\">Fees</div>\n                          <div className=\"value\">{yaggs.fees ? formatMoney(yaggs.fees) : '-'}</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\" title=\"Avg days holding this position\">Avg Days in Trade</div>\n                          <div className=\"value\">{getNumberProperties(round(yaggs.avg_days_in_trade)).comma}</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\" title=\"Total trades, every trade included\">Trades</div>\n                          <div className=\"value\">{getNumberProperties(yaggs.trades).comma}</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\" title=\"Total full trade cycles\">Cycles</div>\n                          <div className=\"value\">{getNumberProperties(yaggs.cycles).comma}</div>\n                        </div>\n                        <div className=\"metric\">\n                          <div className=\"header\" title=\"Total days holding this position\">% Days in Trade</div>\n                          <div className=\"value\">{PERC(yaggs.perc_days_in_trade)}%</div>\n                        </div>\n                      </div>\n                      <div key=\"trades\" className=\"trades\">\n                        { \n                          lData[sym] && latest.date && (latest.date.year() + '') === year && (\n                            <div key={i} className=\"trade\">\n                              <div>Current Position</div>\n                              <div>\n                                <span>{currPL}</span>\n                                <div className={`percent percent-tag ${currPLPerc < 0 ? 'neg' : 'pos'}`}>\n                                  { arrow }\n                                  { currPLPerc }%\n                                </div>\n                              </div>\n                            </div>\n                          )\n                        }\n                        {\n                          [...(yaggs.sell_trades || [])].reverse().map((trade,i) => {\n                            return <div key={i} className=\"trade\">\n                              <div>{moment(trade[0].date).format('L')}</div>\n                              <div>\n                                <span>{formatMoney(trade[0].amount - trade[1] * trade[0].shares)}</span>\n                                <div className={`percent percent-tag ${trade[2] < 0 ? 'neg' : 'pos'}`}>\n                                  { arrow }\n                                  { PERC(trade[2]) }%\n                                </div>\n                              </div>\n                            </div>\n                          })\n                        }\n                      </div>\n                    </div>\n                  }\n                </div>,\n                i !== total.length - 1 && <div key=\"div\" className=\"divider\" />\n              ]\n            })\n          }\n\n          { \n            this.props.mobile && [\n              <div key=\"div\" className=\"divider\" />,\n              <div className=\"detail-transactions\" ref=\"detailtransactions\" key=\"details\" style={{ display: 'none' }}>\n                All Transactions\n                { renderTransactions(sym) }\n              </div> \n            ]\n          }\n        </div>,\n        renderStockOpts()\n      ]\n    }\n\n    if(this.props.mobile) {\n      return (\n        <div \n          ref=\"bg\" \n          className={`history mobile ${this.props.show ? 'show' : ''}`} \n          onClick={e => {\n            if(e.target === this.refs.bg) return this.props.close()\n          }}\n        >\n          <div \n            ref=\"window\"\n            className=\"history-window\"\n            onTouchStart={this.moveWindowStart} \n            onTouchMove={this.moveWindow} \n            onTouchEnd={this.moveWindowEnd}\n            onMouseDown={this.moveWindowStart}\n            onMouseMove={this.moveWindow}\n            onMouseUp={this.moveWindowEnd}\n          >\n            <div className=\"search\">\n              { this.state.showSymbolList ? 'Stocks' : 'Transactions' }\n              <div \n                className=\"btn\" \n                onClick={e => {\n                  this.setState({ \n                    showSymbolList: !this.state.showSymbolList, \n                    showAllTransactions: false \n                  });\n                }}\n              >\n                { this.state.showSymbolList ? <span>+</span> : thinsearch }\n              </div>\n            </div>\n            <div className=\"content\">\n              { renderTransactions() }\n            </div>\n            <div className={`details ${sym ? 'show' : ''}`} ref=\"details\">\n              { renderDetails() }\n            </div>\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <div className={`history ${this.props.show ? 'show' : ''}`} ref=\"bg\" onClick={e => {\n        if(e.target === this.refs.bg) return this.props.close()\n      }}>\n        <div className=\"history-window\">\n          <div className=\"search\">\n            <input \n              ref=\"input\"\n              onKeyDown={e => e.key !== 'Escape' && e.stopPropagation()}\n              placeholder=\"Search History\" \n              onChange={e => this.setState({ \n                search: e.target.value.toLowerCase(), \n                selectedSymbol: null,\n                toggledYears: []\n              })} \n            />\n            { thinsearch }\n          </div>\n          <div className=\"content\">\n            { renderTransactions() }\n            <div className={`details ${sym ? 'with-sym' : ''}`}>\n              { renderDetails() }\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React, { Component } from 'react';\nimport anime from 'animejs';\nimport moment from 'moment';\nimport { \n  Portfolio, \n  Balances, \n  Volatility, \n  Breakdown, \n  Charts,\n  DateScrubber,\n  History,\n} from './components';\nimport {\n  frmt,\n  sepFrmt,\n} from './utils'\nimport {\n  threedot\n} from './utils/icons';\n\nrequire('./Interface.css');\n\nconst TILE_INTRO_DURATION = 1000;\nconst TILE_INTRO_DELAY = 100;\n\nexport default class Interface extends Component {\n  state = {\n    headerIndex: 0,\n    scrubberEnd: this.props.lastDay,\n    showHelp: false,\n    showHistory: false,\n  }\n  meta = {}\n\n  componentWillMount = () => {\n    window.addEventListener('resize', this.handleResize);\n    window.addEventListener('keydown', this.handleKey);\n  }\n\n  componentWillReceiveProps = props => {\n    // console.log(props.activeDates, this.props.activeDates)\n  }\n\n  componentDidUpdate = prevProps => {\n    const { activeDateOpt, activeDates, dataView } = this.props;\n\n    // animation of dates in the header when adjusting dates\n    console.log(this.state.headerIndex, prevProps.activeDates, activeDates)\n    if(!this.state.headerIndex && prevProps.activeDates !== activeDates) { // first header visible\n      const dates = this.refs.dates || document.querySelector('#header-basic .dates');\n      const years = [...dates.getElementsByClassName('year')],\n            rest = [...dates.getElementsByClassName('rest')];\n      const fromStartDate = moment(`${rest[0].textContent} ${years[0] ? years[0].textContent : prevProps.lastDay.year()}`, 'MMM DD YYYY'),\n            toStartDate = rest[1] ? moment(`${rest[1].textContent} ${years[1] ? years[1].textContent : prevProps.lastDay.year()}`, 'MMM DD YYYY') : fromStartDate.clone();\n      const fromDiff = activeDates[0].diff(fromStartDate, 'days'),\n            toDiff = activeDates[1].diff(toStartDate, 'days');\n      const diffs = { fromdiff: 0, todiff: 0, fromdiffhistory: 0, todiffhistory: 0 };\n      console.log('hi')\n      if(this.meta.dateMenuAnim) this.meta.dateMenuAnim.pause();\n      this.meta.dateMenuAnim = anime({\n        targets: diffs, \n        fromdiff: fromDiff,\n        todiff: toDiff,\n        easing: 'easeOutExpo',\n        round: 1,\n        duration: 700,\n        update: () => {\n          console.log('hi')\n          if(diffs.fromdiffhistory === diffs.fromdiff && diffs.todiffhistory === diffs.todiff) return;\n          const currFromDate = fromStartDate.clone().add(diffs.fromdiff, 'days'),\n                currToDate = toStartDate.clone().add(diffs.todiff, 'days');\n          if(years.length) {\n            years[0].innerHTML = ', ' + currFromDate.year();\n            if(years[1]) years[1].innerHTML = ', ' + currToDate.year();\n          }\n          rest[0].innerHTML = currFromDate.format('MMM D');\n          if(rest[1]) rest[1].innerHTML = currToDate.format('MMM D');\n          diffs.fromdiffhistory = diffs.fromdiff;\n          diffs.todiffhistory = diffs.todiff;\n        }\n      })\n    } \n    // move selected opt backgrounds\n    let bg = this.refs.dateOptBg;\n    if(activeDateOpt < 0) bg.style.opacity = 0;\n    else if(!this.meta.loaded || parseFloat(bg.getAttribute('data-index')) !== activeDateOpt) {\n      const opt = this.refs.dateOpts.querySelectorAll('[data-opt]')[activeDateOpt].getBoundingClientRect();\n      const offset = this.refs.dateOpts.getBoundingClientRect().left;\n      bg.style.opacity = 1;\n      bg.style.width = opt.width+'px';\n      bg.style.height = opt.height+'px';\n      bg.style.left = (opt.left - offset)+'px';\n    }\n    bg = this.refs.appOptBg;\n    const { dvDollar, dvPerc } = this.refs;\n    const offset = this.refs.appOpts.getBoundingClientRect().left;\n    const rect = (dataView === '$' ? dvDollar : dvPerc).getBoundingClientRect();\n    bg.style.opacity = 1;\n    bg.style.width = rect.width+'px';\n    bg.style.height = rect.height+'px';\n    bg.style.left = (rect.left - offset)+'px';\n    this.meta.loaded = true;\n  }\n\n  componentDidUpdate = () => {\n    // move selected opt backgrounds\n    const { activeDateOpt, dataView } = this.props;\n    let bg = this.refs.dateOptBg;\n    if(activeDateOpt < 0) bg.style.opacity = 0;\n    else if(!this.meta.loaded || parseFloat(bg.getAttribute('data-index')) !== activeDateOpt) {\n      const opt = this.refs.dateOpts.querySelectorAll('[data-opt]')[activeDateOpt].getBoundingClientRect();\n      const offset = this.refs.dateOpts.getBoundingClientRect().left;\n      bg.style.opacity = 1;\n      bg.style.width = opt.width+'px';\n      bg.style.height = opt.height+'px';\n      bg.style.left = (opt.left - offset)+'px';\n    }\n    bg = this.refs.appOptBg;\n    const { dvDollar, dvPerc } = this.refs;\n    const offset = this.refs.appOpts.getBoundingClientRect().left;\n    const rect = (dataView === '$' ? dvDollar : dvPerc).getBoundingClientRect();\n    bg.style.opacity = 1;\n    bg.style.width = rect.width+'px';\n    bg.style.height = rect.height+'px';\n    bg.style.left = (rect.left - offset)+'px';\n    this.meta.loaded = true;\n  }\n\n  componentWillUnmount = () => {\n    window.removeEventListener('resize', this.handleResize);\n    window.removeEventListener('keydown', this.handleKey);\n  }\n\n  handleKey = e => {\n    const { onSettingsChange, onDateChange } = this.props;\n\n    if(e.code === 'Slash') this.setState({ showHelp: !this.state.showHelp });\n    else if(e.code === 'KeyH') this.setState({ showHistory: !this.state.showHistory });\n    // do not let any others take over if a popup is active\n    else if(this.state.showHelp || this.state.showHistory) {\n      if(e.code === 'Escape') this.setState({ showHelp: false, showHistory: false });\n      return;\n    };\n\n    switch(e.code) {\n      case 'Space': \n        e.preventDefault();\n        e.stopPropagation();\n        return this.changeHeader();\n      case 'KeyD': \n        if(this.state.headerIndex) this.changeHeader();\n        onSettingsChange('dataView', '$');\n        return;\n      case 'KeyP': \n        if(this.state.headerIndex) this.changeHeader();\n        onSettingsChange('dataView', '%');\n        return;\n      case 'KeyF': \n        if(this.state.headerIndex) this.changeHeader();\n        onSettingsChange('feeAdjustments', !this.props.feeAdjustments);\n        return;\n      case 'KeyA': \n        if(this.state.headerIndex) this.changeHeader();\n        onSettingsChange('contributionAdjustments', !this.props.contributionAdjustments);\n        return;\n      case 'Digit1': \n        if(this.state.headerIndex) this.changeHeader();\n        onDateChange('opt', 0);\n        return;\n      case 'Digit3': \n        if(this.state.headerIndex) this.changeHeader();\n        onDateChange('opt', 1);\n        return;\n      // case 'Digit6': \n      //   if(this.state.headerIndex) this.changeHeader();\n      //   onDateChange('opt', 2);\n      //   return;\n      case 'KeyY': \n        if(this.state.headerIndex) this.changeHeader();\n        onDateChange('opt', 2);\n        return;\n      case 'KeyM': \n        if(this.state.headerIndex) this.changeHeader();\n        onDateChange('opt', 3);\n        return;\n      default: return;\n    }\n  }\n\n  changeHeader = e => {\n    const newState = {\n      headerIndex: (this.state.headerIndex + 1) % 3\n    }\n    if(newState.headerIndex === 1) {\n      this.meta.weekdays = null;\n      newState.scrubberEnd = this.meta.activeScrubberEnd || this.props.lastDay;\n    }\n    this.setState(newState);\n  }\n\n  renderDates = () => {\n    const { activeDates } = this.props;\n\n    const fmt = sepFrmt(activeDates[0], activeDates[1]);\n    if(activeDates[0] === activeDates[1]) return (\n      <div className=\"dates\" ref=\"dates\">\n        <span className=\"rest\">{fmt[0].m} {fmt[0].d}</span> \n        {fmt[0].useYear ? <span className=\"year\">, {fmt[0].y}</span> : null}\n      </div>\n    );\n    return (\n      <div className=\"dates\" ref=\"dates\">\n        <span className=\"rest\">{fmt[0].m} {fmt[0].d}</span> \n        {fmt[0].useYear ? <span className=\"year\">, {fmt[0].y}</span> : null}\n        <span>{` - `}</span>\n        <span className=\"rest\">{fmt[1].m} {fmt[1].d}</span> \n        {fmt[1].useYear ? <span className=\"year\">, {fmt[1].y}</span> : null}\n      </div>\n    )\n  }\n\n  hideHistory = e => this.setState({ showHistory: false })\n\n  render = () => {\n    const { \n      headerIndex\n    } = this.state;\n    const {\n      weekdays // hover\n    } = this.meta;\n    const {\n      activeDates,\n      dataView,\n      feeAdjustments,\n      contributionAdjustments,\n      onSettingsChange,\n      onDateChange\n    } = this.props;\n\n    const classes = ['interface'];\n    if(this.state.showHelp || this.state.showHistory) classes.push('blur');\n    if(!this.props.allowAnimations) classes.push('no-animations');\n\n\n    return (\n      <div className={classes.join(' ')}>\n        <div className=\"bg\" />\n        \n        <div ref=\"header\" className=\"interface-header\">\n          <div className=\"header-slider\" data-slide={headerIndex}>\n            <section id=\"header-basic\">\n\n              <div className=\"header-left\">\n                <ul ref=\"appOpts\" className=\"app-opts\">\n                  <div ref=\"appOptBg\" className=\"bg\" data-index={-1} />\n                  <li \n                    className={`icon ${dataView === '$' ? 'active' : ''}`}\n                    ref=\"dvDollar\"\n                    title=\"Use dollar change\"\n                    onClick={dataView === '$' ? null : () => onSettingsChange('dataView', '$')}\n                  ><div className=\"clickitem\">$</div></li>\n                  <li \n                    className={`icon ${dataView === '%' ? 'active' : ''}`}\n                    ref=\"dvPerc\"\n                    title=\"Use percent change\"\n                    onClick={dataView === '%' ? null : () => onSettingsChange('dataView', '%')}\n                  ><div className=\"clickitem\">%</div></li>\n                  <li className=\"divider\" />\n                  <li \n                    className={`single ${feeAdjustments ? 'active' : ''}`}\n                    title=\"Toggle fee-adjusted values\"\n                    onClick={() => onSettingsChange('feeAdjustments', !feeAdjustments)}\n                  ><div className=\"clickitem\">Fees</div></li>\n                  <li \n                    className={`single ${contributionAdjustments ? 'active' : ''}`}\n                    title=\"Toggle backwards contribution adjustments\"\n                    onClick={() => onSettingsChange('contributionAdjustments', !contributionAdjustments)}\n                  ><div className=\"clickitem\">Adj</div></li>\n                </ul>\n              </div>\n\n              { this.renderDates() }\n\n              <div className=\"header-right\">\n                <ul ref=\"dateOpts\" className=\"date-opts\">\n                  <div ref=\"dateOptBg\" className=\"bg\" data-index={-1} />\n                  {\n                    this.props.dateOpts.map((opt, i) => {\n                      const active = this.props.activeDateOpt === i,\n                            formatted = frmt(opt.start, opt.end);\n                      const range = `${formatted[0]} - ${formatted[1]}`;\n                      return <li \n                        key={i}\n                        className={active ? 'active' : ''}\n                        data-opt={i}\n                        title={range}\n                        onClick={active ? null : () => onDateChange('opt', i)}\n                      ><div className=\"clickitem\">{opt.range_count}<span>{opt.range_type}</span></div></li>\n                    })\n                  }\n                </ul>\n              </div>\n            </section>\n\n            <section id=\"header-cal\">\n              <DateScrubber {...this.props} headerIndex={headerIndex} />\n            </section>\n\n            <section id=\"header-btns\">\n              <div>hello world</div>\n            </section>\n          </div>\n          <div\n            className=\"menu-icon\"\n            onClick={this.changeHeader}\n          ><div className=\"clickitem\">{threedot}</div></div>\n        </div>\n\n        <div className=\"interface-content hide-scroll\">\n          <section className=\"tile-col left\">\n            <Portfolio {...this.props} />\n            <Balances {...this.props} />\n            <Volatility {...this.props} />\n          </section>\n          <section className=\"tile-col right\">\n            <Breakdown {...this.props} />\n            <Charts {...this.props} />\n          </section>\n        </div>\n\n        <History \n          show={this.state.showHistory} \n          history={this.props.history} \n          close={this.hideHistory}\n        />\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport anime from 'animejs';\nimport Swipe from 'swipejs';\nimport moment from 'moment';\nimport { \n  Portfolio, \n  Balances, \n  Volatility, \n  Breakdown, \n  Charts,\n  History\n} from './components';\nimport {\n  frmt,\n  sepFrmt,\n  getAlpha,\n  p5map,\n} from './utils';\nimport {\n  angle,\n  history,\n} from './utils/icons';\n\nrequire('./Interface.css');\n\nconst TILE_INTRO_DURATION = 500;\nconst TILE_INTRO_DELAY = 200;\nconst MENU_BG = 0.6;\n\nexport default class InterfaceMobile extends Component {\n  state = {\n    showHistory: false,\n  };\n  meta = {\n    swipe: {\n      acctIndex: 1,\n      posIndex: 0\n    }\n  }\n\n  componentWillMount = () => {\n    this.meta.app = document.getElementById('app');\n  }\n\n  componentDidMount = () => {\n    const processSlides = (index, slides) => {\n      const width = parseFloat(slides[0].style.width);\n      slides[index].children[0].style.transform = 'scale(1)';\n      \n      // scrolling to the first, 2+ should be hidden\n      if(!index) {\n        for(let i=index+2; i<slides.length; i++) {\n          slides[i].style.transform = `translate(${width * 2}px, 0px) translateZ(0px)`;\n          slides[i].style.transitionDuration = '400ms';\n          slides[i].children[0].style.transform = 'scale(.8)';\n          slides[i].children[0].style.transformOrigin = 'left center';\n        }\n        slides[1].children[0].style.transform = 'scale(.8)';\n        slides[1].children[0].style.transformOrigin = 'left center';\n      }\n      // scrolling to anything after second slide, anything before previous should be hidden\n      if(index > 1) {\n        for(let i=index-2; i>=0; i--) {\n          slides[i].style.transform = `translate(${width * -2}px, 0px) translateZ(0px)`;\n          slides[i].style.transitionDuration = '400ms';\n          slides[i].children[0].style.transform = 'scale(.8)';\n          slides[i].children[0].style.transformOrigin = 'right center';\n        }\n        slides[index-1].children[0].style.transform = 'scale(.8)';\n        slides[index-1].children[0].style.transformOrigin = 'right center';\n      }\n      if(index === 1) {\n        slides[0].style.transform = `translate(${width * -1}px, 0px) translateZ(0px)`;\n        slides[0].style.transitionDuration = '400ms';\n        slides[0].children[0].style.transform = 'scale(.8)';\n        slides[0].children[0].style.transformOrigin = 'right center';\n        if(slides[2]) {\n          slides[2].style.transform = `translate(${width}px, 0px) translateZ(0px)`;\n          slides[2].style.transitionDuration = '400ms';\n          slides[2].children[0].style.transform = 'scale(.8)';\n          slides[2].children[0].style.transformOrigin = 'left center';\n        }\n      }\n    }\n\n    // init Swipe instances\n    this.meta.swipe.acct = new Swipe(this.refs.account, {\n      startSlide: this.meta.swipe.acctIndex,\n      speed: 400,\n      draggable: true,\n      continuous: false,\n      disableScroll: true,\n      stopPropagation: true,\n      callback: (index, el, dir) => {\n        this.meta.swipe.acctIndex = index;\n        processSlides(index, [...this.refs.account.querySelectorAll('.swipe-wrap > div')]);\n      },\n    });\n    this.meta.swipe.pos = new Swipe(this.refs.positions, {\n      startSlide: this.meta.swipe.posIndex,\n      speed: 400,\n      draggable: true,\n      continuous: false,\n      disableScroll: true,\n      stopPropagation: true,\n      callback: (index, el, dir) => {\n        this.meta.swipe.posIndex = index;\n        processSlides(index, [...this.refs.positions.querySelectorAll('.swipe-wrap > div')])\n      },\n    });\n\n    //initialize transforms\n    processSlides(this.meta.swipe.acctIndex, [...this.refs.account.querySelectorAll('.swipe-wrap > div')]);\n    processSlides(this.meta.swipe.posIndex, [...this.refs.positions.querySelectorAll('.swipe-wrap > div')]);\n\n    // animate in\n    if(this.meta.tileAnime) this.meta.tileAnime.pause();\n    this.meta.tileAnime = anime.timeline().add({\n      targets: [\n        '#balances',\n        '#breakdown',\n      ],\n      opacity: [0,1],\n      marginTop: [20,0],\n      easing: 'easeInOutSine',\n      duration: TILE_INTRO_DURATION,\n      delay: (el, i, l) => 1000 + (i * TILE_INTRO_DELAY)\n    }).add({\n      targets: [\n        '#portfolio',\n        '#charts',\n        '#volatility'\n      ],\n      opacity: [0,1],\n      offset: '-='+TILE_INTRO_DURATION,\n      easing: 'easeInOutSine',\n      duration: TILE_INTRO_DURATION,\n      delay: (el, i, l) => i * TILE_INTRO_DELAY\n    });\n  }\n\n  componentWillReceiveProps = props => {\n    // animation of dates in the menu when adjusting dates\n    if(this.refs.menu.classList.contains('show')) {\n      const fromElDay = this.refs.menu.querySelector('.from .big'),\n            fromElRest = this.refs.menu.querySelector('.from .small'),\n            toElDay = this.refs.menu.querySelector('.to .big'),\n            toElRest = this.refs.menu.querySelector('.to .small');\n      const fromStartDate = moment(`${fromElRest.textContent} ${fromElDay.textContent}`, 'MMM YYYY DD'),\n            toStartDate = moment(`${toElRest.textContent} ${toElDay.textContent}`, 'MMM YYYY DD');\n      const fromDiff = props.activeDates[0].diff(fromStartDate, 'days'),\n            toDiff = props.activeDates[1].diff(toStartDate, 'days');\n      const diffs = { fromdiff: 0, todiff: 0, fromdiffhistory: 0, todiffhistory: 0 };\n      this.meta.dateMenuAnim = anime({\n        targets: diffs, \n        fromdiff: fromDiff,\n        todiff: toDiff,\n        easing: 'easeOutExpo',\n        round: 1,\n        duration: 1000,\n        update: () => {\n          if(diffs.fromdiffhistory === diffs.fromdiff && diffs.todiffhistory === diffs.todiff) return;\n          const currFromDate = fromStartDate.clone().add(diffs.fromdiff, 'days'),\n                currToDate = toStartDate.clone().add(diffs.todiff, 'days');\n          fromElDay.innerHTML = currFromDate.date();\n          fromElRest.innerHTML = currFromDate.format('MMM YYYY');\n          toElDay.innerHTML = currToDate.date();\n          toElRest.innerHTML = currToDate.format('MMM YYYY');\n          diffs.fromdiffhistory = diffs.fromdiff;\n          diffs.todiffhistory = diffs.todiff;\n        }\n      })\n    }\n  }\n\n  init = e => {\n\n  }\n\n  moveHeaderStart = e => {\n    if(!e || (!e.pageY && !e.touches)) return;\n    const y = e.pageY || (e.touches[0].clientY - 20);\n    this.refs.menu.style.transitionDuration = '0s';\n    this.refs.interface.style.transitionDuration = '0s';\n    this.meta.app.style.transitionDuration = '0s';\n    this.refs.menu.style.transitionTimingFunction = null;\n    this.refs.interface.style.transitionTimingFunction = null;\n    if(!this.meta.app.hasAttribute('data-bg')) {\n      this.meta.app.setAttribute('data-bg', this.meta.app.style.background);\n    }\n    this.meta.drag = {\n      y,\n      alpha: getAlpha(this.meta.app.getAttribute('data-bg')),\n      menuOpen: this.refs.menu.classList.contains('show'),\n      time: performance.now()\n    }\n  }\n\n  moveHeader = e => {\n    const { drag } = this.meta;\n    if(!drag || !e || (!e.pageY && !e.touches)) return;\n    // e.preventDefault();\n    const y = e.pageY || (e.touches[0].clientY - 20);\n    if(y < 0) return;\n    if(drag.menuOpen) { // relative to start point\n      drag.diff = drag.y - y;\n      if(drag.diff < 0) {\n        drag.diff = 0;\n        drag.y = y;\n        drag.time = performance.now();\n      }\n      this.refs.menu.style.top = `-${drag.diff}px`;\n      this.refs.interface.style.top = `calc(100vh - ${drag.diff}px)`;\n      const appbg = p5map(drag.diff, 0, window.screen.height, MENU_BG, drag.alpha);\n      const blur = Math.max(p5map(drag.diff, window.screen.height / 4, window.screen.height / 2, 0, 10), 0);\n      this.meta.app.style.background = `rgba(0,0,0,${appbg})`;\n      this.refs.menu.style.filter = `blur(${blur}px)`;\n    } else { // exact position on screen\n      this.refs.interface.style.top = y + 'px';\n      this.refs.menu.style.top = `calc(-100vh + ${y}px)`;\n      const appbg = p5map(y, 0, window.screen.height, drag.alpha, MENU_BG);\n      const blur = Math.max(p5map(y, 0, window.screen.height / 2, 10, 0), 0);\n      this.meta.app.style.background = `rgba(0,0,0,${appbg})`;\n      this.refs.menu.style.filter = `blur(${blur}px)`;\n    }\n  }\n\n  moveHeaderEnd = e => {\n    if(!this.meta.drag) return;\n    const fast = performance.now() - this.meta.drag.time < 200;\n    if(this.meta.drag.menuOpen) { // hide menu\n      if( (fast && this.meta.drag.diff > window.screen.height * 0.1) ||\n          this.meta.drag.diff > window.screen.height / 4\n      ) {\n        this.hideMenu(fast);\n      } else {\n        this.refs.menu.style.transitionDuration = '0.15s'; // faster speed for short distance\n        this.refs.interface.style.transitionDuration = '0.15s';\n        this.meta.app.style.transitionDuration = '0.15s';\n        this.refs.menu.style.top = 0;\n        this.refs.interface.style.top = '100vh';\n        this.meta.app.style.background = `rgba(0,0,0,${MENU_BG})`;\n        this.refs.menu.style.filter = 'blur(0px)';\n      }\n    } else { // show menu\n      if( (fast && parseFloat(this.refs.interface.style.top) >= window.screen.height / 5) ||\n          parseFloat(this.refs.interface.style.top) >= window.screen.height / 3\n      ) {\n        this.showMenu(fast);\n      } else {\n        this.refs.menu.style.transitionDuration = '0.15s'; // faster speed for short distance\n        this.refs.interface.style.transitionDuration = '0.15s';\n        this.meta.app.style.transitionDuration = '0.15s';\n        this.refs.menu.style.top = null;\n        this.refs.interface.style.top = null;\n        this.meta.app.style.background = `rgba(0,0,0,${this.meta.drag.alpha})`;\n        this.refs.menu.style.filter = 'blur(10px)';\n      }\n    }\n    this.meta.drag = null;\n  }\n\n  showMenu = fast => {\n    if(fast) {\n      this.refs.menu.style.transitionTimingFunction = 'cubic-bezier(.17,.89,.13,1.13)'; // cubic-bezier(0.175, 0.885, 0.32, 1.275)\n      this.refs.interface.style.transitionTimingFunction = 'cubic-bezier(.17,.89,.13,1.13)';\n    } \n    this.refs.menu.style.transitionDuration = null; // slower, original speed\n    this.refs.interface.style.transitionDuration = null;\n    this.meta.app.style.transitionDuration = null;\n    this.refs.menu.classList.add('show');\n    this.refs.menu.style.top = 0;\n    this.refs.interface.style.top = '100vh';\n    this.refs.menu.style.filter = 'blur(0px)';\n    this.meta.app.style.background = `rgba(0,0,0,${MENU_BG})`;\n  }\n\n  hideMenu = fast => {\n    if(fast) {\n      this.refs.menu.style.transitionTimingFunction = 'cubic-bezier(.17,.89,.13,1.13)';\n      this.refs.interface.style.transitionTimingFunction = 'cubic-bezier(.17,.89,.13,1.13)';\n    }\n    this.refs.menu.style.transitionDuration = null; // slower, original speed\n    this.refs.interface.style.transitionDuration = null;\n    this.meta.app.style.transitionDuration = null;\n    this.refs.menu.classList.remove('show');\n    this.refs.menu.style.top = null;\n    this.refs.interface.style.top = null;\n    this.meta.app.style.background = this.meta.app.getAttribute('data-bg');\n    this.refs.menu.style.filter = 'blur(10px)';\n  }\n\n  dateChange = e => {\n    if(!e.target.value) return;\n    let dateFrom = moment(this.refs.from.value, 'YYYY-MM-DD'),\n        dateTo = moment(this.refs.to.value, 'YYYY-MM-DD'),\n        changed = e.target === this.refs.from ? 0 : 1;\n    // limit dates\n    const min = moment(this.props.data.meta.start_date, 'L'),\n          max = moment(this.props.lastDay, 'L');\n    if(dateFrom.isBefore(min)) dateFrom = min;\n    if(dateTo.isAfter(max)) dateTo = max;\n    let range = [dateFrom, dateTo];\n    // keep in min -> max order\n    if(dateFrom.isAfter(dateTo)) {\n      if(changed) {\n        if(dateTo.isBefore(min)) dateTo = min;\n        range = [dateTo, dateTo];\n      } else {\n        if(dateFrom.isAfter(max)) dateFrom = max;\n        range = [dateFrom, dateFrom];\n      }\n    }\n    this.props.onDateChange('range', range);\n  }\n\n  hideHistory = e => this.setState({ showHistory: false })\n\n  render = () => {\n    const dateFrom = this.props.activeDates[0],\n          dateTo = this.props.activeDates[1],\n          formatted = frmt(dateFrom, dateTo),\n          sep = sepFrmt(dateFrom, dateTo),\n          datesRender = (dateFrom === dateTo ? formatted[0] : `${formatted[0]} - ${formatted[1]}`);\n\n    const classes = ['interface'];\n    if(this.state.showHistory) classes.push('shrink');\n    if(!this.props.allowAnimations) classes.push('no-animations');\n\n    return [\n      <div \n        className={classes.join(' ')}\n        key=\"interface\"\n        ref=\"interface\"\n        onTouchStart={this.moveHeaderStart} \n        onTouchMove={this.moveHeader} \n        onTouchEnd={this.moveHeaderEnd}\n        onMouseDown={this.moveHeaderStart}\n        onMouseMove={this.moveHeader}\n        onMouseUp={this.moveHeaderEnd}\n      >\n        <div className=\"bg\" />\n\n        <div className=\"interface-header\" ref=\"header\" onClick={this.showMenu}>\n          <div className=\"quick-action\" onClick={e => {\n            e.stopPropagation();\n            this.setState({ showHistory: true });\n          }}>{history}</div>\n          <div className=\"dates\">{datesRender}</div>\n          <div className=\"quick-action\" />\n        </div>\n\n        <div className=\"interface-content\" ref=\"content\">\n          <section>\n            <div className=\"swipe-shrink\">\n              <div ref=\"account\" className=\"swipe\">\n                <div className=\"swipe-wrap\">\n                  <div style={{transform: 'scale(0.8)', transformOrigin: 'right center'}}><Portfolio mobile {...this.props} /></div>\n                  <div><Balances mobile {...this.props} /></div>\n                  <div style={{transform: 'scale(0.8)', transformOrigin: 'left center'}}><Volatility mobile {...this.props} /></div>\n                </div>\n              </div>\n            </div>\n          </section>\n          <section>\n            <div className=\"swipe-shrink\">\n              <div ref=\"positions\" className=\"swipe\">\n                <div className=\"swipe-wrap\">\n                  <div style={{transform: 'scale(0.8)', transformOrigin: 'right center'}}><Breakdown mobile {...this.props} /></div>\n                  <div><Charts mobile {...this.props} /></div>\n                </div>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>,\n      <div\n        ref=\"menu\"\n        key=\"menu\"\n        className=\"mobile-menu\"\n        onTouchStart={this.moveHeaderStart} \n        onTouchMove={this.moveHeader} \n        onTouchEnd={this.moveHeaderEnd}\n        onMouseDown={this.moveHeaderStart}\n        onMouseMove={this.moveHeader}\n        onMouseUp={this.moveHeaderEnd}\n      >\n        <div className=\"opts\">\n          <div \n            className={`opt icon ${this.props.dataView === '$' ? 'active' : ''}`}\n            onClick={this.props.dataView === '$' ? null : () => this.props.onSettingsChange('dataView', '$')}\n          >$</div>\n          <div \n            className={`opt icon ${this.props.dataView === '%' ? 'active' : ''}`}\n            onClick={this.props.dataView === '%' ? null : () => this.props.onSettingsChange('dataView', '%')}\n          >%</div>\n          <div className=\"opt divider\" />\n          <div \n            className={`opt single ${this.props.feeAdjustments ? 'active' : ''}`}\n            onClick={() => this.props.onSettingsChange('feeAdjustments', !this.props.feeAdjustments)}\n          >Fees</div>\n          <div \n            className={`opt single ${this.props.contributionAdjustments ? 'active' : ''}`}\n            onClick={() => this.props.onSettingsChange('contributionAdjustments', !this.props.contributionAdjustments)}\n          >Adj</div>\n        </div>\n        <div className=\"date-pickers\">\n          <div className=\"from\">\n            <div className=\"text\">\n              <div className=\"big\">{sep[0].d}</div>\n              <div className=\"small\">{sep[0].m} {sep[0].y}</div>\n            </div>\n            <input \n              key={this.props.activeDates[0].format('L')}\n              ref=\"from\"\n              type=\"date\" \n              onBlur={this.dateChange} \n              defaultValue={this.props.activeDates[0].format('YYYY-MM-DD')} \n            />\n          </div>\n          <div className=\"to\">\n            <div className=\"text\">\n              <div className=\"big\">{sep[1].d}</div>\n              <div className=\"small\">{sep[1].m} {sep[1].y}</div>\n            </div>\n            <input \n              key={this.props.activeDates[1].format('L')}\n              ref=\"to\"\n              type=\"date\" \n              onBlur={this.dateChange} \n              defaultValue={this.props.activeDates[1].format('YYYY-MM-DD')} \n            />\n          </div>\n        </div>\n        <div className=\"opts\">\n          {\n            this.props.dateOpts.map((opt, i) => {\n              const active = this.props.activeDateOpt === i;\n              return <div \n                key={i}\n                className={`opt ${active ? 'active' : ''}`}\n                onClick={active ? null : () => this.props.onDateChange('opt', i)}\n              >{opt.range_count}<span>{opt.range_type}</span></div>\n            })\n          }\n        </div>\n        <div className=\"hideBanner\" onClick={this.hideMenu}>{angle}</div>\n      </div>,\n      <History \n        key=\"history\"\n        show={this.state.showHistory} \n        history={this.props.history} \n        close={this.hideHistory}\n        mobile\n      />\n    ]\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { ContentEditable } from './components';\nimport Interface from './Interface'\nimport InterfaceMobile from './InterfaceMobile'\nimport { decrypt, round } from './utils';\nimport anime from 'animejs';\nimport moment from 'moment';\nimport { rotatephone } from './utils/icons';\n\nrequire('./App.css');\n\nconst MOBILE_DEV = false;\n\nconst REQUEST = require('request');\nconst DATA_URL = 'https://raw.githubusercontent.com/DerTarchin/misc/master/.dpd';\nconst IS_ENTER = e => (e.key || e.keyCode) === 'Enter' || e.which === 13;\n\nconst LOGIN_ANIM_DURATION = 1000;\n\nconst NOW = moment();\nconst DATE_OPTS = [\n  { // 1 month\n    range_count: '1',\n    range_type: 'M',\n    start: NOW.clone().subtract(1, 'months'),\n    end: NOW,\n  },\n  { // 3 months\n    range_count: '3',\n    range_type: 'M',\n    start: NOW.clone().subtract(3, 'months'),\n    end: NOW,\n  },\n  // { // 6 months\n  //   range_count: '6',\n  //   range_type: 'M',\n  //   start: NOW.clone().subtract(6, 'months'),\n  //   end: NOW,\n  // },\n  { // 1 year\n    range_count: '1',\n    range_type: 'Y',\n    start: NOW.clone().subtract(12, 'months'),\n    end: NOW,\n  },\n  { // all time\n    range_count: 'ALL',\n    range_type: '',\n    start: moment('2000-1-1'),\n    end: NOW,\n  },\n];\n\nclass App extends Component {\n  state = {\n    // app init\n    data: null,\n    encrypted: true,\n    unlockError: '',\n    showUnlock: true,\n\n    // app settings\n    lastDay: NOW,\n    activeDateOpt: 0,\n    activeDates: [DATE_OPTS[0].start, DATE_OPTS[0].end],\n    feeAdjustments: true,\n    contributionAdjustments: false,\n    dataView: '%',\n  }\n  meta = {}\n\n  componentWillMount = () => {\n    // disable overscroll on mobile\n    // document.addEventListener('touchmove', e => e.preventDefault(), { passive: false });\n    window.addEventListener('orientationchange', () => this.setState({ mobileOrientation: window.orientation }), false);\n  }\n\n  componentDidMount = () => {\n    // retrieve encrypted data\n    if(DATA_URL) REQUEST(DATA_URL, (error, response, body) => {\n      if(error || !body) alert(error);\n      this.meta.encryptedMsg = JSON.parse(body).encryptedMsg;\n      // dev\n      setTimeout(() => this.unlock('dpdev'), 500);\n    });\n\n    // ===\n    if(this.state.encrypted) {\n      // activate anime.js for unlock dialog\n      this.meta.loginAnime = anime({\n        targets: this.refs.unlock,\n        opacity: [0,1],\n        easing: 'easeInQuad',\n        duration: LOGIN_ANIM_DURATION,\n      });\n      this.refs.unlockInput.focus();\n    }\n  }\n\n  unlock = passphrase => {\n    if(!passphrase || !this.state.encrypted) return this.refs.unlockInput.focus();\n    if(!this.meta.encryptedMsg) {\n      this.refs.unlockInput.focus();\n      this.setState({ unlockError: 'Unable to retrieve data.'})\n      return;\n    }\n    const data = decrypt(this.meta.encryptedMsg, passphrase);\n    if(!data) {\n      this.refs.unlockInput.clearContent();\n      this.refs.unlockInput.focus();\n      this.setState({ unlockError: 'Incorrect passphrase.'})\n      return;\n    }\n    console.log(data.dertarchinroth)\n    console.log('%cLast scraped: ' + moment(data.dertarchinroth.meta.timestamp).format('MMMM Do YYYY, h:mm:ss a'), 'font-style: italic')\n\n    // parse data\n    const accounts = Object.keys(data),\n          activeAccount = accounts[0];\n    this.meta.decryptedMsg = data;\n    this.meta.acctData = data[activeAccount];\n    const { acctData } = this.meta;\n    \n    // reset date ranges\n    const lastDay = moment(acctData.meta.last_updated, 'L');\n    while((!lastDay.day() || lastDay.day() === 6) || !acctData[lastDay.format('L')]) {\n      lastDay.subtract(1, 'days');\n    }\n    const startDate = moment(acctData.meta.start_date, 'L');\n    DATE_OPTS[0].start = lastDay.clone().subtract(1,'months');\n    DATE_OPTS[1].start = lastDay.clone().subtract(3,'months');\n    // DATE_OPTS[2].start = lastDay.clone().subtract(6,'months');\n    DATE_OPTS[2].start = lastDay.clone().subtract(1,'years');\n    DATE_OPTS[3].start = startDate;\n    DATE_OPTS.forEach(d => {\n      if(d.start.isBefore(startDate)) d.start = startDate;\n      d.end = lastDay;\n    });\n\n    // sort symbols_traded in meta\n    acctData.meta.symbols_traded = acctData.meta.symbols_traded.sort((a,b) => a < b ? -1 : 1);\n\n    // apply adjustments\n    this.adjData();\n\n    this.setState({ \n      activeData: this.trimData([DATE_OPTS[0].start, DATE_OPTS[0].end]), \n      activeDates: [DATE_OPTS[0].start, DATE_OPTS[0].end],\n      accounts, \n      activeAccount, \n      lastDay,\n      encrypted: false,\n    }, () => {\n      this.meta.loginAnime = anime({\n        targets: this.refs.unlock,\n        opacity: [1,0],\n        easing: 'easeOutQuad',\n        duration: LOGIN_ANIM_DURATION / 2,\n        complete: anim => this.setState({ showUnlock: false })\n      });\n    });    \n  }\n\n  hideUnlockError = e => {\n    e.target.classList.add('hide');\n    this.refs.unlockInput.focus()\n    setTimeout(() => this.setState({ unlockError: '' }), 150);\n  }\n\n  // trims active data to relevant dates, and meta\n  trimData = dates => {\n    dates = dates || this.state.activeDates;\n    const { acctData } = this.meta;\n    const data = { meta: acctData.meta };\n    for(const day = dates[0].clone(); day.isSameOrBefore(dates[1], 'days'); day.add(1, 'days')) {\n      const formatted = day.format('L');\n      data[formatted] = acctData[formatted];\n    }\n    return data;\n  }\n\n  adjData = adj => {\n    const { acctData: data } = this.meta;\n    const {\n      feeAdjustments: fee,\n      // dataView: view,\n      contributionAdjustments: contrib\n    } = adj || this.state;\n    const day = moment(data.meta.last_updated, 'L'),\n          start = moment(data.meta.start_date, 'L');\n    let tcontrib;\n    while(day.isSameOrAfter(start, 'days')) {\n      const d = data[day.format('L')]\n      if(d) {\n        if(!tcontrib) tcontrib = d.total_contributions;\n        adj = {\n          balance: d.balance,\n          cash_balance: d.cash_balance,\n          total_contributions: d.total_contributions\n        };\n        if(!fee) {\n          adj.balance += d.total_fees;\n          adj.cash_balance += d.total_fees;\n        }\n        if(contrib) {\n          adj.balance += (tcontrib - d.total_contributions);\n          adj.cash_balance += (tcontrib - d.total_contributions);\n          adj.total_contributions = tcontrib;\n        }\n        adj.pl = round(adj.balance - adj.total_contributions - d.vts_fees, 2);\n        adj.plPerc = round(adj.pl / (adj.total_contributions + d.vts_fees) * 100, 2);\n        // if(view === '$') {\n        // }\n        // if(view === '%') {\n        // }\n        d.adj = adj;\n      }\n      day.subtract(1, 'days');\n    }\n  }\n\n  onDateChange = (type, val, callback) => {\n    const isOpt = type === 'opt';\n    let activeDateOpt = isOpt ? val : -1,\n        activeDates = isOpt ? [DATE_OPTS[val].start, DATE_OPTS[val].end] : val;\n    // check if date is valid\n    while(!this.meta.acctData[activeDates[0].format('L')]) activeDates[0].add(1, 'days');\n    while(!this.meta.acctData[activeDates[1].format('L')]) activeDates[1].subtract(1, 'days');\n    // check if dates are same as opt\n    if(!isOpt) {\n      DATE_OPTS.forEach((d,i) => {\n        if(activeDateOpt > -1) return;\n        if(d.start.isSame(activeDates[0], 'days') && d.end.isSame(activeDates[1], 'days')) activeDateOpt = i;\n      })\n    }\n    const activeData = this.trimData(activeDates);\n\n    this.setState({ \n      activeDateOpt,\n      activeDates,\n      activeData\n    }, callback);\n  }\n\n  onSettingsChange = (key, val) => {\n    this.adjData({...this.state, [key]: val})\n    this.setState({ [key]: val });\n  }\n\n  render = () => {\n    const isMobile = MOBILE_DEV || window.screen.width <= 767;\n    const interfaceProps = this.state.encrypted ? {} : {\n      data: this.state.activeData,\n      history: this.meta.acctData,\n      \n      lastDay: this.state.lastDay,\n      dateOpts: DATE_OPTS,\n      activeDateOpt: this.state.activeDateOpt,\n      activeDates: this.state.activeDates,\n      onDateChange: this.onDateChange,\n\n      dataView: this.state.dataView,\n      feeAdjustments: this.state.feeAdjustments,\n      contributionAdjustments: this.state.contributionAdjustments,\n      onSettingsChange: this.onSettingsChange,\n\n      // allowAnimations: !isMobile\n      allowAnimations: false,\n    }\n\n    return (\n      <div \n        className={`app ${isMobile ? 'mobile' : ''} ${MOBILE_DEV ? 'dev' : ''}`} \n        id=\"app\"\n        key={this.state.mobileOrientation}\n        style={{background: 'rgba(0,0,0,.15)'}}\n      >\n        {\n          !this.state.showUnlock ? null : \n          <div ref=\"unlock\" className=\"unlock\">\n            <img className=\"logo\" alt=\"\" src={require('./static/logo.svg')}/>\n            <ContentEditable\n              ref=\"unlockInput\"\n              className=\"input\"\n              onKeyDown={e => { if(IS_ENTER(e)) this.unlock(e.target.textContent) }}\n            />\n            {\n              !this.state.unlockError ? null :\n              <div className=\"unlock-error\" onClick={this.hideUnlockError}>{this.state.unlockError}</div>\n            }\n          </div>\n        }\n        { \n          this.state.encrypted ? null : \n          isMobile ? <InterfaceMobile {...interfaceProps}/> : <Interface {...interfaceProps}/> \n        }\n        <div className=\"rotate\">{rotatephone}</div>\n      </div>\n    )\n  }\n}\n\n// ========================================\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);"],"sourceRoot":""}